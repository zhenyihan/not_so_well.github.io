<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Category: 解題區 | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Morris' Blog">
<meta property="og:url" content="http://morris821028.github.io/categories/解題區/page/54/index.html">
<meta property="og:site_name" content="Morris' Blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris' Blog">
<meta name="twitter:description">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          <section id="main">
  
    <article id="post-oj/uva/uva-10713" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/17/oj/uva/uva-10713/" class="article-date">
  <time datetime="2014-07-17T01:02:23.000Z" itemprop="datePublished">2014-07-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/17/oj/uva/uva-10713/">UVa 10713 - Map</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/17/oj/uva/uva-10713/" data-id="ciqasfcdu02gap8xcv5s9hw2j" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/17/oj/uva/uva-10713/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/數學/">數學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>A pirate’s treasure map typically contains a series of instructions which, if followed, lead you from the landing place on a desert isle to the spot marked X where the treasure is buried. You are to construct such a series of instructions for a particular desert isle.</p>
<p>The island is a circle with radius r paces whose centre is at (0,0). Relative to the centre, the point (0,1) is north, (0,-1) is south, (1,0) is east, and (-1,0) is west. Also, (1,1) is northeast, (1,-1) is southeast, (-1,1) is northwest, and (-1,-1) is southwest.</p>
<p>The landing place, on the circumference, is specified by its coordinates. The spot marked X, on the surface of the island is also specified by its coordinates.</p>
<p>Each instruction in the sequence should have the form</p>
<p>   direction distance</p>
<p>where direction is one of { north, south, east, west, northeast, northwest, southeast, southwest } and distance is a non-negative real number indicating the number of paces to be travelled in the given direction. When executed as a sequence the instructions should lead from the landing place to the spot marked X without leaving the island. The total distance (that is, the sum of the distances in your sequence) should be minimized. From the possible sequences that minimize total distance, choose one with the minimum number of instructions.</p>
<p>Input will consist of a number of test cases, followed by a line containing -1. Each test case consists of a single line containing five real numbers: r, x, y, X, Y. r is the radius of the island; x,y are the coordinates of the landing place; X,Y are the coordinates of the spot marked X. The landing place and the spot marked X are distinct.</p>
<p>For each test case, output the sequence, one instruction per line. Distances should be accurate to ten places after the decimal, as shown. Output an empty line between test cases.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">100.0 0.0 100.0 25.0 50.0</span><br><span class="line">-1</span><br></pre></td></tr></table></figure>
<h2 id="Possible-Output-for-Sample-Input"><a href="#Possible-Output-for-Sample-Input" class="headerlink" title="Possible Output for Sample Input"></a>Possible Output for Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">south 25.0000000000</span><br><span class="line">southeast 35.3553390593</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>在一個圓心島嶼上，給定登陸的座標以及寶藏的位置，只能由 8 個方向的指令，在不跑出陸地的情況下，用最少指令抵達目的地。</p>
<p><strong> 題目解法： </strong></p>
<p>很明顯地，保證不超過兩步，但是問題在於要如何不跑出陸地上。</p>
<p>首先，畫一個三角形，保證能用 45 度 + 90 度的情況走到另外一個角，但是對於圓上兩點拉出來平行兩軸的矩形中，能拆分成兩個三角形，對於其中一個做就可以了。</p>
<p>考慮先走 45 度和 90 度其中一個，只會有兩種情況，模擬先走 45 度的情況，查閱是否超出邊界，否則倒序輸出步驟。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-8 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//	freopen("in.txt", "r+t", stdin);</span></span><br><span class="line"><span class="comment">//	freopen("out.txt", "w+t", stdout); </span></span><br><span class="line">    <span class="keyword">double</span> r, x1, x2, y1, y2;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">double</span> sq2 = <span class="built_in">sqrt</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> cases = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%lf %lf %lf %lf %lf"</span>, &amp;r, &amp;x1, &amp;y1, &amp;x2, &amp;y2) == <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(cases++)	<span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">        <span class="keyword">double</span> dx = x2 - x1, dy = y2 - y1;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">fabs</span>(dx) &lt; <span class="built_in">fabs</span>(dy)) &#123;</span><br><span class="line">            <span class="keyword">double</span> diff = <span class="built_in">fabs</span>(dy) - <span class="built_in">fabs</span>(dx);</span><br><span class="line">            <span class="keyword">if</span>(dy &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">double</span> x = x1 + dx, y = y1 - <span class="built_in">fabs</span>(dx);</span><br><span class="line"><span class="comment">//				printf("%lf %lf\n", x, y);</span></span><br><span class="line">                <span class="keyword">if</span>(x*x + y*y &gt; r*r) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">fabs</span>(diff) &gt; eps)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"south %.10lf\n"</span>, diff);</span><br><span class="line">                    <span class="keyword">if</span>(dx &gt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"southeast %.10lf\n"</span>, <span class="built_in">fabs</span>(dx) * sq2);</span><br><span class="line">                    <span class="keyword">if</span>(dx &lt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"southwest %.10lf\n"</span>, <span class="built_in">fabs</span>(dx) * sq2);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(dx &gt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"southeast %.10lf\n"</span>, <span class="built_in">fabs</span>(dx) * sq2);</span><br><span class="line">                    <span class="keyword">if</span>(dx &lt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"southwest %.10lf\n"</span>, <span class="built_in">fabs</span>(dx) * sq2);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">fabs</span>(diff) &gt; eps)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"south %.10lf\n"</span>, diff);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">double</span> x = x1 + dx, y = y1 + <span class="built_in">fabs</span>(dx);</span><br><span class="line">                <span class="keyword">if</span>(x*x + y*y &gt; r*r + eps) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">fabs</span>(diff) &gt; eps)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"north %.10lf\n"</span>, diff);</span><br><span class="line">                    <span class="keyword">if</span>(dx &gt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"northeast %.10lf\n"</span>, <span class="built_in">fabs</span>(dx) * sq2);</span><br><span class="line">                    <span class="keyword">if</span>(dx &lt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"northwest %.10lf\n"</span>, <span class="built_in">fabs</span>(dx) * sq2);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(dx &gt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"northeast %.10lf\n"</span>, <span class="built_in">fabs</span>(dx) * sq2);</span><br><span class="line">                    <span class="keyword">if</span>(dx &lt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"northwest %.10lf\n"</span>, <span class="built_in">fabs</span>(dx) * sq2);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">fabs</span>(diff) &gt; eps)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"north %.10lf\n"</span>, diff);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">double</span> diff = <span class="built_in">fabs</span>(dx) - <span class="built_in">fabs</span>(dy);</span><br><span class="line">            <span class="keyword">if</span>(dx &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">double</span> x = x1 - <span class="built_in">fabs</span>(dy), y = y1 + dy;</span><br><span class="line">                <span class="keyword">if</span>(x*x + y*y &gt; r*r + eps) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">fabs</span>(diff) &gt; eps)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"west %.10lf\n"</span>, diff);</span><br><span class="line">                    <span class="keyword">if</span>(dy &gt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"northwest %.10lf\n"</span>, <span class="built_in">fabs</span>(dy) * sq2);</span><br><span class="line">                    <span class="keyword">if</span>(dy &lt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"southwest %.10lf\n"</span>, <span class="built_in">fabs</span>(dy) * sq2);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(dy &gt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"northwest %.10lf\n"</span>, <span class="built_in">fabs</span>(dy) * sq2);</span><br><span class="line">                    <span class="keyword">if</span>(dy &lt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"southwest %.10lf\n"</span>, <span class="built_in">fabs</span>(dy) * sq2);					</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">fabs</span>(diff) &gt; eps)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"west %.10lf\n"</span>, diff);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">double</span> x = x1 + <span class="built_in">fabs</span>(dy), y = y1 + dy;</span><br><span class="line">                <span class="keyword">if</span>(x*x + y*y &gt; r*r + eps) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">fabs</span>(diff) &gt; eps)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"east %.10lf\n"</span>, diff);</span><br><span class="line">                    <span class="keyword">if</span>(dy &gt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"northeast %.10lf\n"</span>, <span class="built_in">fabs</span>(dy) * sq2);</span><br><span class="line">                    <span class="keyword">if</span>(dy &lt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"southeast %.10lf\n"</span>, <span class="built_in">fabs</span>(dy) * sq2);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(dy &gt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"northeast %.10lf\n"</span>, <span class="built_in">fabs</span>(dy) * sq2);</span><br><span class="line">                    <span class="keyword">if</span>(dy &lt; <span class="number">0</span>)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"southeast %.10lf\n"</span>, <span class="built_in">fabs</span>(dy) * sq2);					</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">fabs</span>(diff) &gt; eps)</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">"east %.10lf\n"</span>, diff);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">    74.584 49.541 55.754 -43.557 -37.453</span><br><span class="line">    74.584 49.541 55.754 23.560 -69.849</span><br><span class="line">    74.584 -40.498 -62.632 0.540 6.183</span><br><span class="line">    74.584 -40.498 -62.632 -14.154 0.389</span><br><span class="line">*/</span></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-149" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/17/oj/uva/uva-149/" class="article-date">
  <time datetime="2014-07-17T00:49:28.000Z" itemprop="datePublished">2014-07-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/17/oj/uva/uva-149/">UVa 149 - Forests</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/17/oj/uva/uva-149/" data-id="ciqasfdrp02z7p8xckorbwvgp" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/17/oj/uva/uva-149/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>The saying <code>You can&#39;t see the wood for the trees</code> is not only a cliche, but is also incorrect. The real problem is that you can’t see the trees for the wood. If you stand in the middle of a <code>wood</code> (in NZ terms, a patch of bush), the trees tend to obscure each other and the number of distinct trees you can actually see is quite small. This is especially true if the trees are planted in rows and columns (as in a pine plantation), because they tend to line up. The purpose of this problem is to find how many distinct trees you can see from an arbitrary point in a pine plantation (assumed to stretch <code>for ever</code>).</p>
<p>picture23</p>
<p>You can only see a distinct tree if no part of its trunk is obscured by a nearer tree–that is if both sides of the trunk can be seen, with a discernible gap between them and the trunks of all trees closer to you. Also, you can’t see a tree if it is apparently <code>too small</code>. For definiteness, <code>not too small</code> and <code>discernible gap</code> will mean that the angle subtended at your eye is greater than 0.01 degrees (you are assumed to use one eye for observing). Thus the two trees marked picture169 obscure at least the trees marked picture175 from the given view point.</p>
<p>Write a program that will determine the number of trees visible under these assumptions, given the diameter of the trees, and the coordinates of a viewing position. Because the grid is infinite, the origin is unimportant, and the coordinates will be numbers between 0 and 1.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>Input will consist of a series of lines, each line containing three real numbers of the form 0.nn. The first number will be the trunk diameter–all trees will be assumed to be cylinders of exactly this diameter, with their centres placed exactly on the points of a rectangular grid with a spacing of one unit. The next two numbers will be the x and y coordinates of the observer. To avoid potential problems, say by being too close to a tree, we will guarantee that tex2html_wrap_inline260 . To avoid problems with trees being too small you may assume that tex2html_wrap_inline262 . The file will be terminated by a line consisting of three zeroes.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>Output will consist of a series of lines, one for each line of the input. Each line will consist of the number of trees of the given size, visible from the given position.</p>
<h2 id="Sample-input"><a href="#Sample-input" class="headerlink" title="Sample input"></a>Sample input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0.10 0.46 0.38</span><br><span class="line">0 0 0</span><br></pre></td></tr></table></figure>
<h2 id="Sample-output"><a href="#Sample-output" class="headerlink" title="Sample output"></a>Sample output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">128</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>所有樹木的圓心都在整數座標上，給定每棵樹的直徑和當前所在位置，問能看見多少棵樹木。</p>
<p>能看見的定義為：看到樹兩側邊緣的張角必須大於 0.01 度，同時要跟之前的前方遮蔽的樹木之間保留 0.01 度之間的間隔。</p>
<p>(也就是說樹不能太細瘦，同時看過去的時候不考慮遠方樹木時，要與前方的樹木之間有小縫隙。)</p>
<p><strong> 題目解法： </strong></p>
<p>由於有限制張角在 0.01 以上，因此太遠的樹木不用考慮，因此窮舉一部分的樹木即可。</p>
<p>對於窮舉位置的樹木，由距離當前位置的數字由小排到大，開始考慮前方是否有樹木遮蔽，因此把每個樹木的張角 [l, r] 先算出來，接著對於一個樹木，查找是否有距離更近的樹木遮蔽。</p>
<p>對於計算張角的部分 (圓外一點)，有兩種做法</p>
<ul>
<li>算出兩切線的交點，來得到兩交點的所形成的角度，保證不超過 180 度。</li>
<li>從起點拉到圓心，算出角度之後，根據切線所形成的三角形，算出 <code>asin</code> 把角度疊加即可。</li>
</ul>
<p>後者比較簡單，前者雖為本次的計算方式，略為不滿意。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-6</span></span><br><span class="line"><span class="keyword">struct</span> Pt &#123;</span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    Pt(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>):</span><br><span class="line">    	x(a), y(b) &#123;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">fabs</span>(x-a.x) &gt; eps)</span><br><span class="line">            <span class="keyword">return</span> x &lt; a.x;</span><br><span class="line">        <span class="keyword">return</span> y &lt; a.y;</span><br><span class="line">    &#125;</span><br><span class="line">    Pt <span class="keyword">operator</span>+(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Pt(x + a.x, y + a.y);</span><br><span class="line">    &#125;</span><br><span class="line">    Pt <span class="keyword">operator</span>-(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Pt(x - a.x, y - a.y);</span><br><span class="line">    &#125;</span><br><span class="line">    Pt <span class="keyword">operator</span>/(<span class="keyword">const</span> <span class="keyword">double</span> a) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Pt(x/a, y/a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dist</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> hypot(a.x - b.x, a.y - b.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dist2</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a.x - b.x)*(a.x - b.x) + (a.y - b.y)*(a.y - b.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">length</span><span class="params">(Pt a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> hypot(a.x, a.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.x * b.x + a.y * b.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross2</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.x * b.y - a.y * b.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(Pt o, Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a.x-o.x)*(b.y-o.y) - (a.y-o.y)*(b.x-o.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">angle</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">acos</span>(dot(a, b) / length(a) / length(b));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Pt <span class="title">getLineIntersection</span><span class="params">(<span class="keyword">double</span> a1, <span class="keyword">double</span> b1, <span class="keyword">double</span> c1, <span class="keyword">double</span> a2, <span class="keyword">double</span> b2, <span class="keyword">double</span> c2)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// a1 x + b1 y + c1 = 0, a2 x + b2 y + c2 = 0</span></span><br><span class="line">    c1 = -c1, c2 = -c2;</span><br><span class="line">    <span class="keyword">double</span> d, dx, dy;</span><br><span class="line">    d = a1 * b2 - a2 * b1;</span><br><span class="line">    dx = c1 * b2 - c2 * b1;</span><br><span class="line">    dy = a1 * c2 - a2 * c1;</span><br><span class="line">    <span class="keyword">return</span> Pt(dx/d, dy/d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getTangentIntersection</span><span class="params">(Pt co, <span class="keyword">double</span> r, Pt p, Pt &amp;pa, Pt &amp;pb)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a, b, c;</span><br><span class="line">    <span class="keyword">double</span> m1a, m1b, m1c, m2a, m2b, m2c, m1, m2;</span><br><span class="line">    a = r*r - (co.x - p.x) * (co.x - p.x);</span><br><span class="line">    b = <span class="number">2</span> * (co.x - p.x) * (co.y - p.y);</span><br><span class="line">    c = r*r - (co.y - p.y) * (co.y - p.y); <span class="comment">// am^2 + bm + c = 0</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">fabs</span>(a) &lt; eps) &#123;</span><br><span class="line">        m2 = (-c)/b;</span><br><span class="line">        m1a = <span class="number">1</span>, m1b = <span class="number">0</span>, m1c = - (m1a * p.x + m1b * p.y);</span><br><span class="line">        m2a = m2, m2b = <span class="number">-1</span>, m2c = - (m2a * p.x + m2b * p.y);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        m1 = (-b + <span class="built_in">sqrt</span>(b*b - <span class="number">4</span>*a*c))/ (<span class="number">2</span>*a);</span><br><span class="line">        m2 = (-b - <span class="built_in">sqrt</span>(b*b - <span class="number">4</span>*a*c))/ (<span class="number">2</span>*a);</span><br><span class="line">        m1a = m1, m1b = <span class="number">-1</span>, m1c = - (m1a * p.x + m1b * p.y);</span><br><span class="line">        m2a = m2, m2b = <span class="number">-1</span>, m2c = - (m2a * p.x + m2b * p.y);</span><br><span class="line">    &#125;</span><br><span class="line">    pa = getLineIntersection(m1a, m1b, m1c, m1b, -m1a, -(m1b * co.x + (-m1a) * co.y));</span><br><span class="line">    pb = getLineIntersection(m2a, m2b, m2c, m2b, -m2a, -(m2b * co.x + (-m2a) * co.y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> Interval &#123;</span><br><span class="line">    Pt p;</span><br><span class="line">    <span class="keyword">double</span> dist, l, r;</span><br><span class="line">    Interval(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>, <span class="keyword">double</span> c = <span class="number">0</span>, Pt d = Pt()):</span><br><span class="line">        dist(a), l(b), r(c), p(d) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Interval &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dist &lt; x.dist;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Pt pa, pb, co(<span class="number">1</span>, <span class="number">1</span>), p(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">double</span> diameter, radius;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%lf %lf %lf"</span>, &amp;diameter, &amp;p.x, &amp;p.y) == <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">fabs</span>(diameter) &lt; eps)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="built_in">vector</span>&lt;Interval&gt; interval;</span><br><span class="line">        radius = diameter/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">-20</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">-20</span>; j &lt; <span class="number">20</span>; j++) &#123;</span><br><span class="line">                getTangentIntersection(Pt(i, j), radius, p, pa, pb);</span><br><span class="line">                <span class="keyword">double</span> t1, t2;</span><br><span class="line">                t1 = <span class="built_in">atan2</span>(pa.y - p.y, pa.x - p.x);</span><br><span class="line">                t2 = <span class="built_in">atan2</span>(pb.y - p.y, pb.x - p.x);</span><br><span class="line">                <span class="keyword">if</span>(t1 &gt; t2)	swap(t1, t2);</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">fabs</span>(t1 - t2)*<span class="number">180</span>/pi &lt; <span class="number">0.01f</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                interval.push_back(Interval(<span class="built_in">pow</span>(pa.x-p.x, <span class="number">2</span>)+<span class="built_in">pow</span>(pb.y-p.y, <span class="number">2</span>), t1, t2, Pt(i, j)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(interval.begin(), interval.end());</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; interval.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">double</span> t1 = interval[i].l, t2 = interval[i].r;</span><br><span class="line">            <span class="keyword">if</span>(t2 - t1 &lt; pi) &#123;</span><br><span class="line">                <span class="keyword">int</span> f = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">                    <span class="keyword">double</span> l = max(t1, interval[j].l), r = min(t2, interval[j].r);</span><br><span class="line">                    <span class="keyword">if</span>(l &lt;= r + <span class="number">0.01f</span> * pi/<span class="number">180</span>)</span><br><span class="line">                        f = <span class="number">0</span>, j = i;</span><br><span class="line">                &#125;</span><br><span class="line">                ret += f;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;				</span><br><span class="line">                <span class="keyword">double</span> t3, t4;</span><br><span class="line">                t3 = t2, t4 = pi;</span><br><span class="line">                t2 = t1, t1 = -pi;</span><br><span class="line">                <span class="keyword">int</span> f = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">                    <span class="keyword">double</span> l = max(t1, interval[j].l), r = min(t2, interval[j].r);</span><br><span class="line">                    <span class="keyword">if</span>(l &lt;= r + <span class="number">0.01f</span> * pi/<span class="number">180</span>)</span><br><span class="line">                        f = <span class="number">0</span>, j = i;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(!f)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                t1 = t3, t2 = t4;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">                    <span class="keyword">double</span> l = max(t1, interval[j].l), r = min(t2, interval[j].r);</span><br><span class="line">                    <span class="keyword">if</span>(l &lt;= r + <span class="number">0.01f</span> * pi/<span class="number">180</span>)</span><br><span class="line">                        f = <span class="number">0</span>, j = i;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(!f)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                ret += f;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ret);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">0.10 0.46 0.38</span><br><span class="line">*/</span></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12240" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/06/oj/uva/uva-12240/" class="article-date">
  <time datetime="2014-07-06T07:56:57.000Z" itemprop="datePublished">2014-07-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/06/oj/uva/uva-12240/">UVa 12240 - Cocircular Points</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/06/oj/uva/uva-12240/" data-id="ciqasfd5d02pdp8xc2j2e6bbu" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/06/oj/uva/uva-12240/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/外心/">外心</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/窮舉/">窮舉</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>You probably know what a set of collinear points is: a set of points such that there exists a straight line that passes through all of them. A set of cocircular points is defined in the same fashion, but instead of a straight line, we ask that there is a circle such that every point of the set lies over its perimeter.</p>
<p>The International Collinear Points Centre (ICPC) has assigned you the following task: given a set of points, calculate the size of the larger subset of cocircular points.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>Each test case is given using several lines. The first line contains an integer N representing the number of points in the set (1<span>$\le$</span><!-- Has MathJax -->N<span>$\le$</span><!-- Has MathJax -->100). Each of the next N lines contains two integers X and Y representing the coordinates of a point of the set (- 104<span>$\le$</span><!-- Has MathJax -->X, Y<span>$\le$</span><!-- Has MathJax -->104). Within each test case, no two points have the same location.</p>
<p>The last test case is followed by a line containing one zero.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each test case output a single line with a single integer representing the number of points in one of the largest subsets of the input that are cocircular.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">7 </span><br><span class="line">-10 0 </span><br><span class="line">0 -10 </span><br><span class="line">10 0 </span><br><span class="line">0 10 </span><br><span class="line">-20 10 </span><br><span class="line">-10 20 </span><br><span class="line">-2 4 </span><br><span class="line">4 </span><br><span class="line">-10000 10000 </span><br><span class="line">10000 10000 </span><br><span class="line">10000 -10000 </span><br><span class="line">-10000 -9999 </span><br><span class="line">3 </span><br><span class="line">-1 0 </span><br><span class="line">0 0 </span><br><span class="line">1 0 </span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">5 </span><br><span class="line">3 </span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>給平面上 n 個點，最多有多少個點共圓？</p>
<p><strong> 題目解法： </strong></p>
<p>窮舉三點拉外心，隨後找共圓的點，最慘會到 O(n^4)。</p>
<p>完全沒有剪枝，也就是說可以刻意將點保留標記，防止窮舉到相同組合，又或者是先按照 x 軸排序，直接在區間內搜索可能的共圓點之類的。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#include &lt;math.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">#define eps 1e-6</span><br><span class="line">struct Pt &#123;</span><br><span class="line">    double x, y;</span><br><span class="line">    Pt(double a = 0, double b = 0):</span><br><span class="line">    	x(a), y(b) &#123;&#125;</span><br><span class="line">    bool operator&lt;(const Pt &amp;a) const &#123;</span><br><span class="line">        if(fabs(x-a.x) &gt; eps)</span><br><span class="line">            return x &lt; a.x;</span><br><span class="line">        return y &lt; a.y;</span><br><span class="line">    &#125;</span><br><span class="line">    Pt operator+(const Pt &amp;a) const &#123;</span><br><span class="line">        return Pt(x + a.x, y + a.y);</span><br><span class="line">    &#125;</span><br><span class="line">    Pt operator-(const Pt &amp;a) const &#123;</span><br><span class="line">        return Pt(x - a.x, y - a.y);</span><br><span class="line">    &#125;</span><br><span class="line">    Pt operator/(const double a) const &#123;</span><br><span class="line">        return Pt(x/a, y/a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">double dist(Pt a, Pt b) &#123;</span><br><span class="line">    return hypot(a.x - b.x, a.y - b.y);</span><br><span class="line">&#125;</span><br><span class="line">double dist2(Pt a, Pt b) &#123;</span><br><span class="line">    return (a.x - b.x)*(a.x - b.x) + (a.y - b.y)*(a.y - b.y);</span><br><span class="line">&#125;</span><br><span class="line">double length(Pt a) &#123;</span><br><span class="line">    return hypot(a.x, a.y);</span><br><span class="line">&#125;</span><br><span class="line">double dot(Pt a, Pt b) &#123;</span><br><span class="line">    return a.x * b.x + a.y * b.y;</span><br><span class="line">&#125;</span><br><span class="line">double cross2(Pt a, Pt b) &#123;</span><br><span class="line">    return a.x * b.y - a.y * b.x;</span><br><span class="line">&#125;</span><br><span class="line">double cross(Pt o, Pt a, Pt b) &#123;</span><br><span class="line">    return (a.x-o.x)*(b.y-o.y) - (a.y-o.y)*(b.x-o.x);</span><br><span class="line">&#125;</span><br><span class="line">double angle(Pt a, Pt b) &#123;</span><br><span class="line">    return acos(dot(a, b) / length(a) / length(b));</span><br><span class="line">&#125;</span><br><span class="line">Pt rotateRadian(Pt a, double radian) &#123;</span><br><span class="line">    double x, y;</span><br><span class="line">    x = a.x * cos(radian) - a.y * sin(radian);</span><br><span class="line">    y = a.x * sin(radian) + a.y * cos(radian);</span><br><span class="line">    return Pt(x, y);</span><br><span class="line">&#125;</span><br><span class="line">Pt getIntersection(Pt p, Pt l1, Pt q, Pt l2) &#123;</span><br><span class="line">    double a1, a2, b1, b2, c1, c2;</span><br><span class="line">    double dx, dy, d;</span><br><span class="line">    a1 = l1.y, b1 = -l1.x, c1 = a1 * p.x + b1 * p.y;</span><br><span class="line">    a2 = l2.y, b2 = -l2.x, c2 = a2 * q.x + b2 * q.y;</span><br><span class="line">    d = a1 * b2 - a2 * b1;</span><br><span class="line">    dx = b2 * c1 - b1 * c2;</span><br><span class="line">    dy = a1 * c2 - a2 * c1;</span><br><span class="line">    return Pt(dx / d, dy / d);</span><br><span class="line">&#125;</span><br><span class="line">Pt circle(Pt a, Pt b, Pt c) &#123;</span><br><span class="line">    Pt mab = (a + b)/2;</span><br><span class="line">    Pt mbc = (b + c)/2;</span><br><span class="line">    Pt lab = b - a, lbc = c - b;</span><br><span class="line">    swap(lab.x, lab.y);</span><br><span class="line">    swap(lbc.x, lbc.y);</span><br><span class="line">    lab.x = -lab.x;</span><br><span class="line">    lbc.x = -lbc.x;</span><br><span class="line">    return getIntersection(mab, lab, mbc, lbc);</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    int n;</span><br><span class="line">    Pt D[128];</span><br><span class="line">    while(scanf("%d", &amp;n) == 1 &amp;&amp; n) &#123;</span><br><span class="line">        for(int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">            scanf("%lf %lf", &amp;D[i].x, &amp;D[i].y);</span><br><span class="line">        &#125;</span><br><span class="line">        int ret = min(2, n);</span><br><span class="line">        for(int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">            for(int j = i + 1; j &lt; n; j++) &#123;</span><br><span class="line">                for(int k = j + 1; k &lt; n; k++) &#123;</span><br><span class="line">                    if(fabs(cross(D[i], D[j], D[k])) &lt; eps)</span><br><span class="line">                        continue;</span><br><span class="line">                    Pt o = circle(D[i], D[j], D[k]);</span><br><span class="line">//					printf("%lf %lf %lf %lf %lf %lf\n", D[i].x, D[i].y, D[j].x, D[j].y, D[k].x, D[k].y);</span><br><span class="line">//					printf("circle %lf %lf\n", o.x, o.y);</span><br><span class="line">                    double d = dist2(o, D[i]);</span><br><span class="line">                    int cnt = 0;</span><br><span class="line">                    for(int p = 0; p &lt; n; p++) &#123;</span><br><span class="line">                        if(fabs(d - dist2(D[p], o)) &lt; eps)</span><br><span class="line">                            cnt++;</span><br><span class="line">                    &#125;</span><br><span class="line">                    ret = max(ret, cnt);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        printf("%d\n", ret);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12206" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/06/oj/uva/uva-12206/" class="article-date">
  <time datetime="2014-07-06T07:51:25.000Z" itemprop="datePublished">2014-07-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/06/oj/uva/uva-12206/">UVa 12206 - Stammering Aliens</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/06/oj/uva/uva-12206/" data-id="ciqasfd9x02rgp8xc0s0oodzm" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/06/oj/uva/uva-12206/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SA/">SA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Suffix-Array/">Suffix Array</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/二分/">二分</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/後綴數組/">後綴數組</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Dr. Ellie Arroway has established contact with an extraterrestrial civilization. However, all efforts to decode their messages have failed so far because, as luck would have it, they have stumbled upon a race of stuttering aliens! Her team has found out that, in every long enough message, the most important words appear repeated a certain number of times as a sequence of consecutive characters, even in the middle of other words. Furthermore, sometimes they use contractions in an obscure manner. For example, if they need to say bab twice, they might just send the message babab, which has been abbreviated because the second b of the first word can be reused as the first b of the second one.</p>
<p>Thus, the message contains possibly overlapping repetitions of the same words over and over again. As a result, Ellie turns to you, S.R. Hadden, for help in identifying the gist of the message.</p>
<p>Given an integer m, and a string s, representing the message, your task is to find the longest substring of s that appears at least m times. For example, in the message baaaababababbababbab, the length-5 word babab is contained 3 times, namely at positions 5, 7 and 12 (where indices start at zero). No substring appearing 3 or more times is longer (see the first example from the sample input). On the other hand, no substring appears 11 times or more (see example 2).</p>
<p>In case there are several solutions, the substring with the rightmost occurrence is preferred (see example 3).</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The input contains several test cases. Each test case consists of a line with an integer m (m<span>$\ge$</span><!-- Has MathJax -->1), the minimum number of repetitions, followed by a line containing a string s of length between m and 40 000, inclusive. All characters in s are lowercase characters from <code>a&#39;&#39; to</code>z’’. The last test case is denoted by m = 0 and must not be processed.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>Print one line of output for each test case. If there is no solution, output none; otherwise, print two integers in a line, separated by a space. The first integer denotes the maximum length of a substring appearing at least m times; the second integer gives the rightmost possible starting position of such a substring.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">baaaababababbababbab</span><br><span class="line">11</span><br><span class="line">baaaababababbababbab</span><br><span class="line">3</span><br><span class="line">cccccc</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">5 12</span><br><span class="line">none</span><br><span class="line">4 2</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>對於一個字串，找到一段最長子字串出現至少 m 次，若存有多個輸出最右邊位置的子字串。</p>
<p><strong> 題目解法： </strong></p>
<p>建造後綴數組，得到高度數組後，二分搜索長度，然後掃描高度數組找尋是否有連續大於等於 m 次的區間。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> SuffixArray &#123;</span><br><span class="line">    <span class="keyword">int</span> sa[<span class="number">40005</span>], h[<span class="number">40005</span>], n;</span><br><span class="line">    <span class="keyword">int</span> w[<span class="number">40005</span>], ta[<span class="number">40005</span>], tb[<span class="number">40005</span>];</span><br><span class="line">    <span class="keyword">char</span> str[<span class="number">40005</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span> *x, <span class="keyword">int</span> *y, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">            w[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            w[x[y[i]]]++;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; m; i++)</span><br><span class="line">            w[i] += w[i<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">for</span>(i = n<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            sa[--w[x[y[i]]]] = y[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> *r, <span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> l)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(r[a] == r[b]) &#123;</span><br><span class="line">            <span class="keyword">if</span>(a+l &gt;= n || b+l &gt;= n)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">return</span> r[a+l] == r[b+l];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build_h</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i, j, k;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)  ta[sa[i]] = i;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(ta[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                h[ta[i]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">0</span> || h[ta[i<span class="number">-1</span>]] &lt;= <span class="number">1</span>)</span><br><span class="line">                k = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                k = h[ta[i<span class="number">-1</span>]]<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">while</span>(str[sa[ta[i]<span class="number">-1</span>]+k] == str[sa[ta[i]]+k])</span><br><span class="line">                k++;</span><br><span class="line">            h[ta[i]] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;<span class="comment">// x: rank, y: second key</span></span><br><span class="line">        <span class="keyword">int</span> i, k, m = <span class="number">128</span>, p;</span><br><span class="line">        <span class="keyword">int</span> *x = ta, *y = tb, *z;</span><br><span class="line">        n = <span class="built_in">strlen</span>(str);</span><br><span class="line">        x[n] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            x[i] = str[i], y[i] = i;</span><br><span class="line">        sort(x, y, m);</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">1</span>, p = <span class="number">1</span>; p &lt; n; k *= <span class="number">2</span>, m = p) &#123;</span><br><span class="line">            <span class="keyword">for</span>(p = <span class="number">0</span>, i = n-k; i &lt; n; i++)</span><br><span class="line">                y[p++] = i;</span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(sa[i] &gt;= k) &#123;</span><br><span class="line">                    y[p++] = sa[i]-k;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            sort(x, y, m);</span><br><span class="line">            z = x, x = y, y = z;</span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">1</span>, p = <span class="number">1</span>, x[sa[<span class="number">0</span>]] = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                x[sa[i]] = cmp(y, sa[i<span class="number">-1</span>], sa[i], k) ? p<span class="number">-1</span> : p++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">SuffixArray in;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//	freopen("in.txt", "r+t", stdin);</span></span><br><span class="line"><span class="comment">//	freopen("out.txt", "w+t", stdout); </span></span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m) == <span class="number">1</span> &amp;&amp; m) &#123;</span><br><span class="line">    	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, in.str);</span><br><span class="line">        in.build();</span><br><span class="line">        in.build_h();</span><br><span class="line">        <span class="keyword">if</span>(m == <span class="number">1</span>) &#123;</span><br><span class="line">        	<span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, in.n, <span class="number">0</span>);</span><br><span class="line">        	<span class="keyword">continue</span>;</span><br><span class="line">    	&#125;</span><br><span class="line"><span class="comment">//        for(int i = 0; i &lt; in.n; i++)</span></span><br><span class="line"><span class="comment">//        	printf("%s %d\n", in.str + in.sa[i], in.h[i]);</span></span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">1</span>, r = in.n, mid, ret = <span class="number">-1</span>, retpos;</span><br><span class="line">        <span class="keyword">while</span>(l &lt;= r) &#123;</span><br><span class="line">        	mid = (l + r)/<span class="number">2</span>;</span><br><span class="line">        	<span class="keyword">int</span> cnt = <span class="number">1</span>, mxtime = <span class="number">0</span>, mxpos = <span class="number">0</span>;</span><br><span class="line">        	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= in.n; i++) &#123;</span><br><span class="line">        		<span class="keyword">if</span>(i != in.n &amp;&amp; in.h[i] &gt;= mid)</span><br><span class="line">        			cnt++;</span><br><span class="line">        		<span class="keyword">else</span> &#123;</span><br><span class="line">        			<span class="keyword">if</span>(mxtime &lt; cnt)</span><br><span class="line">        				mxtime = cnt;</span><br><span class="line">        			<span class="keyword">if</span>(cnt &gt;= m) &#123;</span><br><span class="line">        				<span class="keyword">int</span> j = i;</span><br><span class="line">        				<span class="keyword">do</span> &#123;</span><br><span class="line">        					j--;</span><br><span class="line">        					mxpos = max(mxpos, in.sa[j]);</span><br><span class="line">        				&#125; <span class="keyword">while</span>(in.h[j] &gt;= mid &amp;&amp; j &gt;= <span class="number">0</span>);</span><br><span class="line">        			&#125;</span><br><span class="line">        			cnt = <span class="number">1</span>;</span><br><span class="line">        		&#125;</span><br><span class="line">        	&#125;</span><br><span class="line">        	<span class="keyword">if</span>(mxtime &gt;= m)</span><br><span class="line">        		l = mid + <span class="number">1</span>, ret = mid, retpos = mxpos;</span><br><span class="line">        	<span class="keyword">else</span></span><br><span class="line">        		r = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(ret == <span class="number">-1</span>)</span><br><span class="line">        	<span class="built_in">puts</span>(<span class="string">"none"</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        	<span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, ret, retpos);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">1</span><br><span class="line">aaaaa</span><br><span class="line">2</span><br><span class="line">ufzyetzjulljnkbaohjsqpiucxjo</span><br><span class="line">*/</span></span><br></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12194" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/06/oj/uva/uva-12194/" class="article-date">
  <time datetime="2014-07-06T07:39:27.000Z" itemprop="datePublished">2014-07-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/06/oj/uva/uva-12194/">UVa 12194 - Isosceles Triangles</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/06/oj/uva/uva-12194/" data-id="ciqasfd5j02pgp8xc28skxiez" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/06/oj/uva/uva-12194/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/組合/">組合</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>A given triangle can be either equilateral (three sides of the same length), scalene (three sides of different lengths), or isosceles (two sides of the same length and a third side of a different length). It is a known fact that points with all integer coordinates cannot be the vertices of an equilateral triangle.</p>
<p>You are given a set of different points with integer coordinates on the XY plane, such that no three points in the set lay on the same line. Your job is to calculate how many of the possible choices of three points are the vertices of an isosceles triangle.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>There are several test cases. Each test case is given in several lines. The first line of each test case contains an integer N indicating the number of points in the set (3<span>$\le$</span><!-- Has MathJax -->N<span>$\le$</span><!-- Has MathJax -->1000). Each of the next N lines describes a different point of the set using two integers X and Y separated by a single space (1<span>$\le$</span><!-- Has MathJax -->X, Y<span>$\le$</span><!-- Has MathJax -->106); these values represent the coordinates of the point on the XY plane. You may assume that within each test case no two points have the same location and no three points are collinear.</p>
<p>The last test case is followed by a line containing a single zero.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each test case output a single line with a single integer indicating the number of subsets of three points that are the vertices of an isosceles triangle.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">5 </span><br><span class="line">1 2 </span><br><span class="line">2 1 </span><br><span class="line">2 2 </span><br><span class="line">1 1 </span><br><span class="line">1000 1000000 </span><br><span class="line">6 </span><br><span class="line">1000 1000 </span><br><span class="line">996 1003 </span><br><span class="line">996 997 </span><br><span class="line">1003 996 </span><br><span class="line">1003 1004 </span><br><span class="line">992 1000 </span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">10</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>給平面 N 個點，任挑三個點有多少以某個節點為頂點的等腰三角形。</p>
<p><strong> 題目解法： </strong></p>
<p>直接對單一頂點找到對於其他頂點的的所有距離，排序後找重複的長度進行組合計算，將複雜度 O(n^3) 降到 O(n^2 log n)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> X[<span class="number">1024</span>], Y[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N) == <span class="number">1</span> &amp;&amp; N) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld %lld"</span>, &amp;X[i], &amp;Y[i]); </span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> d[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j++)</span><br><span class="line">                d[j] = (X[i] - X[j]) * (X[i] - X[j]) +</span><br><span class="line">                        (Y[i] - Y[j]) * (Y[i] - Y[j]);</span><br><span class="line">            sort(d, d+N);</span><br><span class="line">            <span class="keyword">long</span> <span class="keyword">long</span> cnt = <span class="number">1</span>;</span><br><span class="line">            d[N] = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(d[j] != d[j<span class="number">-1</span>]) &#123;</span><br><span class="line">                    ret += cnt * (cnt<span class="number">-1</span>) /<span class="number">2</span>;</span><br><span class="line">                    cnt = <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    cnt++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ret);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12191" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/06/oj/uva/uva-12191/" class="article-date">
  <time datetime="2014-07-06T07:22:35.000Z" itemprop="datePublished">2014-07-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/06/oj/uva/uva-12191/">UVa 12191 - File Recover</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/06/oj/uva/uva-12191/" data-id="ciqasfd7902q7p8xcymuibhl4" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/06/oj/uva/uva-12191/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SA/">SA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Suffix-Array/">Suffix Array</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/後綴數組/">後綴數組</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Your school has a computer that is used as a web server for hosting its institutional web site, personal pages of the staff, sites for research groups, subjects, and many others.</p>
<p>Recently, the hard disk table was corrupted, so the organization of all the files was lost. Sadly enough, there are no backups of that information. The only hope is to look through the entire disk data and try to find out which parts correspond to each file. Fortunately, the disk was using a file system that kept each individual file contiguous, so only contiguous pieces of data need to be inspected.</p>
<p>The disk data is a sequence of bytes. Each byte in this particular disk can store an English alphabet letter (distinguishing lowercase and uppercase), a decimal digit, a point or a comma, making a total of 64 different characters.</p>
<p>While you were thinking about how to solve the problem, you suddenly remembered that the file system also maintained multiple copies of each file, so only the pieces of contiguous bytes that are repeated had a chance of being a file. Moreover, for each repetition of the same contiguous bytes, only one copy needs to be checked. For instance, if the data is <code>ababcabb&#39;, the contiguous subsequences</code>a’, <code>b&#39; and</code>ab’ are repeated, but nothing containing <code>c&#39;, nor</code>ba’ or `bb’ is. Therefore, we have 3 pieces of contiguous bytes that need checking in this case.</p>
<p>You decide to write a program that computes exactly how many sequences need checking, that is, the number of different sequences of contiguous bytes that appear at least twice in the data.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>There are several test cases. The input of each test case is given in exactly one line, containing a non-empty string of at most 105 characters that represents the disk data. Each character in the string is either a lowercase letter, an uppercase letter, a digit, a point or a comma.</p>
<p>The last test case is followed by a line containing a single asterisk.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each test case output a single line with an integer, representing the number of different contiguous subsequences that appear at least twice in the input string.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ababcabb </span><br><span class="line">mississippi </span><br><span class="line">aaaaaaaaaaaaaaaaaaaaaaaaaa </span><br><span class="line">012345678,abcdefg.STUVWXYZ </span><br><span class="line">say.twice,say.twice </span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">3 </span><br><span class="line">9 </span><br><span class="line">25 </span><br><span class="line">0 </span><br><span class="line">45</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>有多少不同的子字串符合出現至少兩次的條件。</p>
<p><strong> 題目解法： </strong></p>
<p>建造後綴數組，得到高度數組後，根據遞增的情況進行計算不同字符串的個數。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">struct</span> SuffixArray &#123;</span><br><span class="line">    <span class="keyword">int</span> sa[<span class="number">100005</span>], h[<span class="number">100005</span>], n;</span><br><span class="line">    <span class="keyword">int</span> w[<span class="number">100005</span>], ta[<span class="number">100005</span>], tb[<span class="number">100005</span>];</span><br><span class="line">    <span class="keyword">char</span> str[<span class="number">100005</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span> *x, <span class="keyword">int</span> *y, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">            w[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            w[x[y[i]]]++;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; m; i++)</span><br><span class="line">            w[i] += w[i<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">for</span>(i = n<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            sa[--w[x[y[i]]]] = y[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> *r, <span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> l)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(r[a] == r[b]) &#123;</span><br><span class="line">            <span class="keyword">if</span>(a+l &gt;= n || b+l &gt;= n)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">return</span> r[a+l] == r[b+l];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build_h</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i, j, k;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)  ta[sa[i]] = i;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(ta[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                h[ta[i]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">0</span> || h[ta[i<span class="number">-1</span>]] &lt;= <span class="number">1</span>)</span><br><span class="line">                k = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                k = h[ta[i<span class="number">-1</span>]]<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">while</span>(str[sa[ta[i]<span class="number">-1</span>]+k] == str[sa[ta[i]]+k])</span><br><span class="line">                k++;</span><br><span class="line">            h[ta[i]] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;<span class="comment">// x: rank, y: second key</span></span><br><span class="line">        <span class="keyword">int</span> i, k, m = <span class="number">128</span>, p;</span><br><span class="line">        <span class="keyword">int</span> *x = ta, *y = tb, *z;</span><br><span class="line">        n = <span class="built_in">strlen</span>(str);</span><br><span class="line">        x[n] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            x[i] = str[i], y[i] = i;</span><br><span class="line">        sort(x, y, m);</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">1</span>, p = <span class="number">1</span>; p &lt; n; k *= <span class="number">2</span>, m = p) &#123;</span><br><span class="line">            <span class="keyword">for</span>(p = <span class="number">0</span>, i = n-k; i &lt; n; i++)</span><br><span class="line">                y[p++] = i;</span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(sa[i] &gt;= k) &#123;</span><br><span class="line">                    y[p++] = sa[i]-k;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            sort(x, y, m);</span><br><span class="line">            z = x, x = y, y = z;</span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">1</span>, p = <span class="number">1</span>, x[sa[<span class="number">0</span>]] = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                x[sa[i]] = cmp(y, sa[i<span class="number">-1</span>], sa[i], k) ? p<span class="number">-1</span> : p++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">SuffixArray in;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>, in.str)) &#123;</span><br><span class="line">    	<span class="keyword">if</span>(!<span class="built_in">strcmp</span>(<span class="string">"*"</span>, in.str))</span><br><span class="line">    		<span class="keyword">break</span>;</span><br><span class="line">        in.build();</span><br><span class="line">        in.build_h();</span><br><span class="line"><span class="comment">//		for(int i = 0; i &lt; in.n; i++)</span></span><br><span class="line"><span class="comment">//			printf("%s %d\n", in.str + in.sa[i], in.h[i]);</span></span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>, base = <span class="number">0</span>;</span><br><span class="line">        in.h[in.n] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= in.n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(in.h[i] &lt; in.h[i<span class="number">-1</span>])</span><br><span class="line">                ret += in.h[i<span class="number">-1</span>] - base, base = in.h[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ret);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12176" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/06/oj/uva/uva-12176/" class="article-date">
  <time datetime="2014-07-06T07:01:15.000Z" itemprop="datePublished">2014-07-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/06/oj/uva/uva-12176/">UVa 12176 - Bring Your Own Horse</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/06/oj/uva/uva-12176/" data-id="ciqasfd5602p9p8xchvoy7xuc" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/06/oj/uva/uva-12176/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LCA/">LCA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MST/">MST</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>One of the essential activities of a knight is to compete in tournaments. Frequently, groups of knights gather around the country to compare their skills. On such a typical contest day, everyone has five hours to do ten disciplines, such as sword fighting, bow and arrow, and various forms of horseback riding. Needless to say, you have to bring your own horse.</p>
<p>This is not as easy as it seems. It often takes a knight several days to go from the castle where he lives to the place where a tournament is held. But horses sometimes are very, very stubborn. After having covered a certain distance on a single day, they sometimes simply stop and refuse to go any further. Luckily, they start anew on the next day. To make sure that the horse does not refuse service before the scheduled day trip is completed, a knight wants to choose an itinerary on which the longest day trip is as short as possible. Hence, a trip that takes many days with short distances is preferable over a shorter route that has the risk of a refusing horse.</p>
<p>Write a program which answers queries from knights spread all over the country about the best way to go from their castles to a tournament site. Given a description of the relevant places (i.e. castles, locations of tournaments, and hostels for overnight stays), the program should tell them the largest distance they have to cover on a single day so that this distance is minimal among all possible itineraries.</p>
<p>The places are designated by consecutive integers from 1 to <span>$N$</span><!-- Has MathJax -->, while a road is represented by three integers, namely its place of origin, its destination, and its length. Every road can be used in both directions, and there is at least one route (i.e. a sequence of roads) between any two places. The knights stick to the given roads while travelling and spend their nights only at one of the <span>$N$</span><!-- Has MathJax --> places.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The first line contains the total number of test cases that follow.</p>
<p>Each test case begins with a line that first holds the number <span>$N$</span><!-- Has MathJax --> of places ( <span>$1 \le N \le 3000$</span><!-- Has MathJax --> ) followed by the number <span>$R$</span><!-- Has MathJax --> of roads ( <span>$1 \le R \le 100000$</span><!-- Has MathJax --> ). Then there are <span>$R$</span><!-- Has MathJax --> lines with three integers each (<span>$a$</span><!-- Has MathJax --> , <span>$b$</span><!-- Has MathJax --> , and <span>$l$</span><!-- Has MathJax --> ), each of which defines a road connecting the places <span>$a$</span><!-- Has MathJax --> and <span>$b$</span><!-- Has MathJax --> ( <span>$1 \le a, b \le N$</span><!-- Has MathJax --> ) with length <span>$l$</span><!-- Has MathJax --> ( <span>$1 \le l \le 1000000$</span><!-- Has MathJax --> ).</p>
<p>Thereafter, each test case continues with the number <span>$Q$</span><!-- Has MathJax --> of queries on a line by itself ( <span>$1 \le Q \le 1000$</span><!-- Has MathJax --> ). Each of the next <span>$Q$</span><!-- Has MathJax --> lines holds two integers <span>$k$</span><!-- Has MathJax --> and <span>$t$</span><!-- Has MathJax --> , indicating a query by a knight who lives at place <span>$k$</span><!-- Has MathJax --> and needs to go to a tournament at place <span>$t$</span><!-- Has MathJax --> ( <span>$1 \le k, t \le N$</span><!-- Has MathJax --> , <span>$k \neq t$</span><!-- Has MathJax --> ).</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each test case output a line containing the word ``Case’’, a single space, and its serial number (starting with <span>$1$</span><!-- Has MathJax --> for the first test case). Then, print one line for each query in this test case, containing the smallest maximal day trip distance as described above. Print a blank line after each test case.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">4 4</span><br><span class="line">1 2 100</span><br><span class="line">2 3 100</span><br><span class="line">3 4 100</span><br><span class="line">4 1 200</span><br><span class="line">1</span><br><span class="line">1 4</span><br><span class="line">6 9</span><br><span class="line">2 4 5</span><br><span class="line">5 1 7</span><br><span class="line">3 6 6</span><br><span class="line">3 1 4</span><br><span class="line">2 3 2</span><br><span class="line">1 2 1</span><br><span class="line">6 5 42</span><br><span class="line">4 5 3</span><br><span class="line">4 6 5</span><br><span class="line">4</span><br><span class="line">1 3</span><br><span class="line">3 4</span><br><span class="line">5 4</span><br><span class="line">6 1</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">## Sample Output ##</span><br></pre></td></tr></table></figure>
<p>Case 1<br>100</p>
<p>Case 2<br>2<br>5<br>3<br>5<br>```</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>騎士每天活動只會從該點移動到盡可能短的路徑到下一個點，求從起點到終點之間的最小的最長路為何。</p>
<p><strong> 題目解法： </strong></p>
<p>由於詢問兩個點之間的路徑上的最小值最大邊，不外乎地可以先做一次最小成本樹，根據定義，拆分成 s - t 集合，最小成本樹的邊一定是 s - t 之間的最小邊。</p>
<p>接著詢問在樹上進行即可，因此每次詢問最慘會到 O(n)。</p>
<p>那我們稍微加速，採用 dp 的方式，將樹變成有根樹，記錄每一個節點向上攀升 1 個節點, 2 個節點, 4 個節點 …, 2^n 個節點的路徑上的最大最小值。</p>
<p>因此狀態會是 O(n log n), 建表也能在 O(n log n) 完成，接著調整兩個詢問節點的高度，先想辦法調整到兩個節點到水平高度，藉由之前的計算，高度不超過 n，因此理應可以在 O(log n) 時間內完成到調整到同一水平高度。</p>
<p>在同一水平下，還是需要知道 LCA 的所在高度，否則也可以水平線不斷地一步一步往上提，雖然最慘也許是 O(n) 但是經由之前的調整已經很加速很多。</p>
<p>本來應該套用 LCA Tarjan 的作法來加速，但是還沒有做到這樣的地步速度就很快。如果詢問次數再多一點就必須做到這一步。</p>
<p>有點懶惰 Orz。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">struct</span> E &#123;</span><br><span class="line">    <span class="keyword">int</span> x, y, v;</span><br><span class="line">    E(<span class="keyword">int</span> a=<span class="number">0</span>, <span class="keyword">int</span> b=<span class="number">0</span>, <span class="keyword">int</span> c=<span class="number">0</span>):</span><br><span class="line">        x(a), y(b), v(c) &#123;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> E &amp;a) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span>  v &lt; a.v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">E D[<span class="number">100005</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;E&gt; tree[<span class="number">3005</span>];</span><br><span class="line"><span class="keyword">int</span> p[<span class="number">3005</span>], rank[<span class="number">3005</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findp</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p[x] == x ? x : (p[x] = findp(p[x]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">joint</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    x = findp(x), y = findp(y);</span><br><span class="line">    <span class="keyword">if</span>(x == y)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(rank[x] &gt; rank[y])</span><br><span class="line">        rank[x] += rank[y], p[y] = x;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        rank[y] += rank[x], p[x] = y;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">kruscal</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    sort(D, D+m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        p[i] = i, rank[i] = <span class="number">1</span>;</span><br><span class="line">        tree[i].clear();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(joint(D[i].x, D[i].y)) &#123;</span><br><span class="line">        	sum += D[i].v;</span><br><span class="line">        	tree[D[i].x].push_back(E(D[i].x, D[i].y, D[i].v));</span><br><span class="line">        	tree[D[i].y].push_back(E(D[i].y, D[i].x, D[i].v));</span><br><span class="line"><span class="comment">//        	printf("mmm %d %d %d\n", D[i].x, D[i].y, D[i].v);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">4096</span>][<span class="number">20</span>], dpw[<span class="number">4096</span>][<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> treeLevel[<span class="number">4096</span>], treePath[<span class="number">4096</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p, <span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">    treeLevel[u] = level, treePath[level] = u;	</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; (<span class="number">1</span>&lt;&lt;i) &lt; level; i++) &#123;</span><br><span class="line">        dp[u][i] = max(dp[u][i<span class="number">-1</span>], dp[dpw[u][i<span class="number">-1</span>]][i<span class="number">-1</span>]);</span><br><span class="line">        dpw[u][i] = treePath[level-(<span class="number">1</span>&lt;&lt;i)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tree[u].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = tree[u][i].y;</span><br><span class="line">        <span class="keyword">if</span>(v == p)	<span class="keyword">continue</span>;		</span><br><span class="line">        dp[v][<span class="number">0</span>] = tree[u][i].v;</span><br><span class="line">        dpw[v][<span class="number">0</span>] = u;</span><br><span class="line">        dfs(v, u, level + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> hx = treeLevel[x], hy = treeLevel[y];</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x != y &amp;&amp; hx != hy) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">15</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">abs</span>(hx-hy) &gt;= (<span class="number">1</span>&lt;&lt;i)) &#123;</span><br><span class="line">                <span class="keyword">if</span>(hx &gt; hy) &#123;</span><br><span class="line">                    ret = max(ret, dp[x][i]);</span><br><span class="line">                    x = dpw[x][i];</span><br><span class="line">                    hx -= (<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    ret = max(ret, dp[y][i]);</span><br><span class="line">                    y = dpw[y][i];</span><br><span class="line">                    hy -= (<span class="number">1</span>&lt;&lt;i); </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(x != y) &#123;</span><br><span class="line">        ret = max(ret, dp[x][<span class="number">0</span>]);</span><br><span class="line">        x = dpw[x][<span class="number">0</span>];</span><br><span class="line">        hx -= (<span class="number">1</span>&lt;&lt;<span class="number">0</span>);</span><br><span class="line">        ret = max(ret, dp[y][<span class="number">0</span>]);</span><br><span class="line">        y = dpw[y][<span class="number">0</span>];</span><br><span class="line">        hy -= (<span class="number">1</span>&lt;&lt;<span class="number">0</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//	freopen("in.txt", "r+t", stdin);</span></span><br><span class="line"><span class="comment">//	freopen("out.txt", "w+t", stdout); </span></span><br><span class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</span><br><span class="line">    <span class="keyword">while</span>(testcase--) &#123;</span><br><span class="line">        <span class="keyword">int</span> n, m, q, x, y;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        	<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;D[i].x, &amp;D[i].y, &amp;D[i].v);        	</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> mstcost = kruscal(n, m);</span><br><span class="line">        <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">        <span class="built_in">memset</span>(dpw, <span class="number">0</span>, <span class="keyword">sizeof</span>(dpw));</span><br><span class="line">        dfs(<span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line"><span class="comment">//		for(int i = 1; i &lt;= n; i++, puts("")) &#123;</span></span><br><span class="line"><span class="comment">//			printf("[%2d] :", i);</span></span><br><span class="line"><span class="comment">//			for(int j = 0; (1&lt;&lt;j) &lt;= n; j++)</span></span><br><span class="line"><span class="comment">//				printf("%d %d, ", dp[i][j], dpw[i][j]);</span></span><br><span class="line"><span class="comment">//		&#125;</span></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d\n"</span>, ++cases);</span><br><span class="line">        <span class="keyword">while</span>(q--) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, query(x, y));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">5</span><br><span class="line">10 45</span><br><span class="line">1 2 15</span><br><span class="line">1 3 11</span><br><span class="line">1 4 48</span><br><span class="line">1 5 24</span><br><span class="line">1 6 45</span><br><span class="line">1 7 18</span><br><span class="line">1 8 12</span><br><span class="line">1 9 40</span><br><span class="line">1 10 11</span><br><span class="line">2 3 4</span><br><span class="line">2 4 9</span><br><span class="line">2 5 44</span><br><span class="line">2 6 23</span><br><span class="line">2 7 39</span><br><span class="line">2 8 48</span><br><span class="line">2 9 48</span><br><span class="line">2 10 22</span><br><span class="line">3 4 42</span><br><span class="line">3 5 37</span><br><span class="line">3 6 10</span><br><span class="line">3 7 18</span><br><span class="line">3 8 29</span><br><span class="line">3 9 8</span><br><span class="line">3 10 47</span><br><span class="line">4 5 7</span><br><span class="line">4 6 17</span><br><span class="line">4 7 25</span><br><span class="line">4 8 23</span><br><span class="line">4 9 32</span><br><span class="line">4 10 27</span><br><span class="line">5 6 26</span><br><span class="line">5 7 21</span><br><span class="line">5 8 38</span><br><span class="line">5 9 40</span><br><span class="line">5 10 39</span><br><span class="line">6 7 35</span><br><span class="line">6 8 11</span><br><span class="line">6 9 39</span><br><span class="line">6 10 1</span><br><span class="line">7 8 15</span><br><span class="line">7 9 10</span><br><span class="line">7 10 47</span><br><span class="line">8 9 28</span><br><span class="line">8 10 11</span><br><span class="line">9 10 1</span><br><span class="line">30</span><br><span class="line">1 6</span><br><span class="line"></span><br><span class="line">5</span><br><span class="line">10 45</span><br><span class="line">1 2 9</span><br><span class="line">1 3 12</span><br><span class="line">1 4 21</span><br><span class="line">1 5 4</span><br><span class="line">1 6 32</span><br><span class="line">1 7 20</span><br><span class="line">1 8 14</span><br><span class="line">1 9 28</span><br><span class="line">1 10 16</span><br><span class="line">2 3 12</span><br><span class="line">2 4 23</span><br><span class="line">2 5 27</span><br><span class="line">2 6 34</span><br><span class="line">2 7 43</span><br><span class="line">2 8 2</span><br><span class="line">2 9 33</span><br><span class="line">2 10 35</span><br><span class="line">3 4 41</span><br><span class="line">3 5 26</span><br><span class="line">3 6 16</span><br><span class="line">3 7 39</span><br><span class="line">3 8 2</span><br><span class="line">3 9 49</span><br><span class="line">3 10 44</span><br><span class="line">4 5 24</span><br><span class="line">4 6 2</span><br><span class="line">4 7 17</span><br><span class="line">4 8 26</span><br><span class="line">4 9 20</span><br><span class="line">4 10 2</span><br><span class="line">5 6 23</span><br><span class="line">5 7 5</span><br><span class="line">5 8 41</span><br><span class="line">5 9 12</span><br><span class="line">5 10 15</span><br><span class="line">6 7 48</span><br><span class="line">6 8 45</span><br><span class="line">6 9 13</span><br><span class="line">6 10 28</span><br><span class="line">7 8 25</span><br><span class="line">7 9 12</span><br><span class="line">7 10 37</span><br><span class="line">8 9 4</span><br><span class="line">8 10 5</span><br><span class="line">9 10 41</span><br><span class="line">30</span><br><span class="line">5 4</span><br><span class="line">1 7</span><br><span class="line">8 4</span><br><span class="line">*/</span></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12045" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/06/oj/uva/uva-12045/" class="article-date">
  <time datetime="2014-07-06T06:00:52.000Z" itemprop="datePublished">2014-07-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/06/oj/uva/uva-12045/">UVa 12045 - Fun with Strings</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/06/oj/uva/uva-12045/" data-id="ciqasfd1p02nlp8xcp587jqq7" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/06/oj/uva/uva-12045/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/D-C/">D&C</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/矩陣/">矩陣</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Zibon just started his courses in Computer science. After having some lectures on programming courses he fell in love with strings. He started to play with strings and experiments on them. One day he started a string of arbitrary (of course positive) length consisting of only {a, b}. He considered it as 1st string and generated subsequent strings from it by replacing all the b’s with ab and all the a’s with b. For example, if he ith string is abab, (i+1)th string will be b(ab)b(ab) = babbab. He found that the Nth string has the length X and Mth string has the length Y. He wondered what will be length of the Kth string. Can you help him?</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The first line of the input file contains an integer T (T ≤ 1000) which denotes the total number of test cases. The description of each test case is given below:</p>
<p>Five integers N, X, M, Y and K where (0 &lt; N, M, X, Y, K &lt; 109 and N ≠ M).</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each test case produce one line of output giving either the number which is desired length (modulo 1000000007) or the string “Impossible”. You output Impossible if the given input is not possible.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">3 16 5 42 6</span><br><span class="line">5 1 6 10 9</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">68</span><br><span class="line">Impossible</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>一開始由 a, b 構成的字串，每一次操作會將 a 換成 b, 將 b 換成 ab。<br>在第 N 次之後長度為 X、第 M 次之後長度為 Y，求第 K 次之後長度為何？</p>
<p><strong> 題目解法： </strong></p>
<p>看到 a 換成 b, 將 b 換成 ab，其實只考量數量關係，很明顯是一個費式數列的關係。<br>因此，只要假設一開始有多少個 a，有多少個 b 在一開始的字串中，利用兩條方程式求解，之後再帶入費式數列的快速運算即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Matrix &#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> v[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">    Matrix(<span class="keyword">long</span> <span class="keyword">long</span> a = <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(&amp;v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">            v[i][i] = a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> mod = <span class="number">1000000007L</span>L;</span><br><span class="line"><span class="function">Matrix <span class="title">multiply</span><span class="params">(Matrix x, Matrix y)</span> </span>&#123;</span><br><span class="line">    Matrix z;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; j++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">2</span>; k++) &#123;</span><br><span class="line">                z.v[i][j] += x.v[i][k] * y.v[k][j] %mod;</span><br><span class="line">                z.v[i][j] %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Matrix <span class="title">pow</span><span class="params">(Matrix x, <span class="keyword">long</span> <span class="keyword">long</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="function">Matrix <span class="title">v</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span>(y) &#123;</span><br><span class="line">        <span class="keyword">if</span>(y&amp;<span class="number">1</span>)</span><br><span class="line">            v = multiply(v, x);</span><br><span class="line">        y = y&gt;&gt;<span class="number">1</span>, x = multiply(x, x); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> testcase;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> N, X, M, Y, K;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</span><br><span class="line">    <span class="keyword">while</span>(testcase--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld %lld %lld %lld %lld"</span>, &amp;N, &amp;X, &amp;M, &amp;Y, &amp;K);</span><br><span class="line">        Matrix mm, na, nb, nc;</span><br><span class="line">        mm.v[<span class="number">0</span>][<span class="number">0</span>] = mm.v[<span class="number">0</span>][<span class="number">1</span>] = mm.v[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        na = <span class="built_in">pow</span>(mm, N);</span><br><span class="line">        nb = <span class="built_in">pow</span>(mm, M);</span><br><span class="line">        nc = <span class="built_in">pow</span>(mm, K);</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> a1, b1, c1, a2, b2, c2;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> d, dx, dy;</span><br><span class="line">        a1 = na.v[<span class="number">0</span>][<span class="number">0</span>], b1 = na.v[<span class="number">1</span>][<span class="number">0</span>], c1 = X;</span><br><span class="line">        a2 = nb.v[<span class="number">0</span>][<span class="number">0</span>], b2 = nb.v[<span class="number">1</span>][<span class="number">0</span>], c2 = Y;</span><br><span class="line">        d = a1 * b2 - a2 * b1;</span><br><span class="line">        dx = X * b2 - Y * b1, dy = a1 * Y - a2 * X;</span><br><span class="line">        <span class="keyword">if</span>(d == <span class="number">0</span> || dx%d || dy%d || dx/d &lt; <span class="number">0</span> || dy/d &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"Impossible"</span>);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">long</span> <span class="keyword">long</span> a = dx/d, b = dy/d;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (a * nc.v[<span class="number">0</span>][<span class="number">0</span>]%mod + b * nc.v[<span class="number">1</span>][<span class="number">0</span>]%mod)%mod);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//		printf("%lld A + %lld B = %lld\n", na.v[0][0], na.v[1][0], X);</span></span><br><span class="line"><span class="comment">//		printf("%lld A + %lld B = %lld\n", nb.v[0][0], nb.v[1][0], Y);</span></span><br><span class="line"><span class="comment">//		printf("%lld A + %lld B = ????\n", nc.v[0][0], nc.v[1][0]);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12042" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/06/oj/uva/uva-12042/" class="article-date">
  <time datetime="2014-07-06T05:45:42.000Z" itemprop="datePublished">2014-07-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/06/oj/uva/uva-12042/">UVa 12042 - Colorful Eggs</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/06/oj/uva/uva-12042/" data-id="ciqasfd1x02nop8xcyx7n8r4s" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/06/oj/uva/uva-12042/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/D-C/">D&C</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/矩陣/">矩陣</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Little Mou is very fond of eggs. She has n baskets for keeping her colorful eggs. Each basket contains eggs of different colors. The baskets are numbered from 1 to n. She has a strange hobby about these eggs. On each day, she takes each basket starting from the nth basket. When she is doing this for basket i, she counts all eggs placed in baskets 1 to i (inclusive) and takes their sum. Let this value of sum be counti. She removes all old eggs from the ith basket and keeps counti new eggs in the ith basket. After that she puts all the old eggs of the ith basket in the (i-1)th basket removing the old eggs of the (i-1)th basket. As Mou is very fond of eggs, she eats all old eggs of the (i-1)th basket. And when she has finished eating, she repeats the work for this (i-1)th basket. If she reaches the 1st basket, she stops her work and doesn’t eat any more eggs and goes to sleep!</p>
<p>For example let Mou has 3 baskets at day 1. 1st basket contains 1 egg, 2nd basket contains 1 egg and the 3rd basket contains 2 eggs.</p>
<p>So simulation for day 3 follows:</p>
<p>Basket Index =&gt; 3 2 1</p>
<p>….. 略</p>
<p>Now the problem is given n, d and the number of eggs in each basket eggi, your job is to find the number of eggs in each basket after d days. As the number can be very big output answer modulo 1,000,000,007.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The first line of the input file contains an integer T (T ≤ 111) which denotes the total number of test cases. The description of each test case is given below:</p>
<p>Two integers N (1 ≤ n ≤ 60) and d (1 ≤ d ≤ 1,000,000,000), followed by n integers denoting the number of eggs in each basket starting from 1 to n.<br>Output</p>
<p>For each test case print one line of output containing the number of eggs in each basket after d days have passed separated by single spaces between them. See the sample output for more details. As the numbers can be very big output answer modulo 1,000,000,007.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">3 7</span><br><span class="line">1 2 3</span><br><span class="line">2 2</span><br><span class="line">4 5</span><br><span class="line">2 1</span><br><span class="line">1 10</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">129 189 277</span><br><span class="line">5 9</span><br><span class="line">1 10</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>一開始有 n 籃雞蛋，每一籃有各自個雞蛋數量。</p>
<p>每一次的操作從最右邊 (編號大的那籃開始) 進行，將所有比它小的編號的雞蛋總數加到這一籃，並且將原本的雞蛋總數指派給下一個籃。</p>
<p>問第 d 天後的結果。</p>
<p><strong> 題目解法： </strong></p>
<p>建造轉移矩陣，使用 D&amp;C 完成。</p>
<p>觀察一下可以發現，矩陣肯定長成這副德性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[1, 1, 1, ..., 1, 1, 1]</span><br><span class="line">[1, 0, 1, ..., 1, 1, 1]</span><br><span class="line">[1, 0, 0, 1, ..., 1, 1] = M</span><br><span class="line">[1, 0, 0, 0, ..., 1, 1]</span><br><span class="line">...</span><br><span class="line">[1, 0, 0, 0, ..., 0, 0]</span><br><span class="line"></span><br><span class="line">[an]</span><br><span class="line">[an-1]</span><br><span class="line">[an-2] = A(1)</span><br><span class="line">...</span><br><span class="line">[a1]</span><br><span class="line"></span><br><span class="line">M x A(1) = A(2)</span><br><span class="line">M x M x A(1) = A(3)</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">const long long mod = 1000000007LL;</span><br><span class="line">struct Matrix &#123;</span><br><span class="line">    long long v[64][64];</span><br><span class="line">    int row, col; // row x col</span><br><span class="line">    Matrix(int n, int m, long long a = 0) &#123;</span><br><span class="line">        memset(v, 0, sizeof(v));</span><br><span class="line">        row = n, col = m;</span><br><span class="line">        for(int i = 0; i &lt; row &amp;&amp; i &lt; col; i++)</span><br><span class="line">            v[i][i] = a;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix operator*(const Matrix&amp; x) const &#123;</span><br><span class="line">        Matrix ret(row, x.col);</span><br><span class="line">        for(int i = 0; i &lt; row; i++)</span><br><span class="line">            for(int j = 0; j &lt; x.col; j++)</span><br><span class="line">                for(int k = 0; k &lt; col; k++)</span><br><span class="line">                    ret.v[i][j] += v[i][k] * x.v[k][j] %mod,</span><br><span class="line">                    ret.v[i][j] %= mod;</span><br><span class="line">        return ret;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix operator^(const int&amp; n) const &#123;</span><br><span class="line">        Matrix ret(row, col, 1), x = *this;</span><br><span class="line">        int y = n;</span><br><span class="line">        while(y) &#123;</span><br><span class="line">            if(y&amp;1)	ret = ret * x;</span><br><span class="line">            y = y&gt;&gt;1, x = x * x;</span><br><span class="line">        &#125;</span><br><span class="line">        return ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">int main() &#123;</span><br><span class="line">    int testcase, n, d, a[105];</span><br><span class="line">    scanf("%d", &amp;testcase);</span><br><span class="line">    while(testcase--) &#123;</span><br><span class="line">        scanf("%d %d", &amp;n, &amp;d);</span><br><span class="line">        d--;</span><br><span class="line">        for(int i = 0; i &lt; n; i++)</span><br><span class="line">            scanf("%d", &amp;a[i]);</span><br><span class="line">        Matrix x(n, n), A(n, 1);</span><br><span class="line">        for(int i = 0; i &lt; n; i++)</span><br><span class="line">            A.v[i][0] = a[n-i-1];</span><br><span class="line">        for(int i = 0; i &lt; n; i++)</span><br><span class="line">            x.v[0][i] = 1;</span><br><span class="line">        for(int i = 1; i &lt; n; i++) &#123;</span><br><span class="line">            for(int j = i+1; j &lt; n; j++) &#123;</span><br><span class="line">                x.v[i][j] = 1;</span><br><span class="line">            &#125;</span><br><span class="line">            x.v[i][0] = 1;</span><br><span class="line">        &#125;</span><br><span class="line">        Matrix y = x ^ d;</span><br><span class="line">        Matrix r = y * A;</span><br><span class="line">        for(int i = r.row-1; i &gt;= 0; i--) &#123; </span><br><span class="line">            printf("%lld", r.v[i][0]);</span><br><span class="line">            if(i)	putchar(' ');</span><br><span class="line">        &#125; </span><br><span class="line">        puts("");</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12040" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/06/oj/uva/uva-12040/" class="article-date">
  <time datetime="2014-07-06T05:36:06.000Z" itemprop="datePublished">2014-07-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/06/oj/uva/uva-12040/">UVa 12040 - Again Lucky Numbers</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/06/oj/uva/uva-12040/" data-id="ciqasfd1802nfp8xc51jqpb0z" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/06/oj/uva/uva-12040/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AC自動機/">AC自動機</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Some people believe that 13 is an unlucky number. So they always want to avoid the number 13. But I believe that 7 is an unlucky number and want to avoid it. So unlucky number is different for man to man. If 13 is an unlucky number and in a number there is no 13 (i.e. no ‘1’ is followed by a ‘3’) then we can call it a lucky number. For example, if we consider 13 as an unlucky number then 12345 is a lucky number. But if any number contains 13 then it is not a lucky number, such as 13254 and 21345 are not lucky numbers. Given the number of digits N in a number and the unlucky number M, you have to find out how many lucky numbers are possible with N digits considering that M is unlucky number. Note that leading 0’s are not allowed. So, 011 is not a valid three digit number.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The first line of the input file contains an integer T (T ≤ 1000) which denotes the total number of test cases. The description of each test case is given below:</p>
<p>Two positive integers N (1 ≤ N ≤ 100), M (1 ≤ M ≤ 10100).</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each test case print the number of lucky numbers of N digits considering that M is the unlucky number. The result may be very large. You have to output the result modulo 10000007.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">1 3</span><br><span class="line">2 13</span><br><span class="line">2 1</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">9</span><br><span class="line">89</span><br><span class="line">72</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>找到長度為 n 的數字，並且數字中不會出現指定的數字為 substring，求符合數字的總數。</p>
<p><strong> 題目解法： </strong></p>
<p>特別考慮以 0 開頭的情況 (n 位數字前導不可為 0，但 n = 1 位數字可以是 0)。<br>最後，建造一台 AC 自動機，接著對於每一個節點著手 dp 轉移。</p>
<p>也就是考慮再將字串進行 AC 自動機匹配時所會遇到的所有轉移情況，因此我們要避免出現指定的字符串時，在結尾處標記不可轉移即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// http://mypaper.pchome.com.tw/zerojudge/post/1324462879</span></span><br><span class="line"><span class="comment">// AC 自動機 DP</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">struct</span> Node &#123;</span><br><span class="line">    Node *next[<span class="number">10</span>], *fail, *prev;</span><br><span class="line">    <span class="keyword">int</span> eos;<span class="comment">//prefix has a string end</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> dp[<span class="number">105</span>]; <span class="comment">// [string length]</span></span><br><span class="line">    <span class="keyword">int</span> ASCII;</span><br><span class="line">    Node() &#123;</span><br><span class="line">        fail = <span class="literal">NULL</span>, prev = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="built_in">memset</span>(next, <span class="number">0</span>, <span class="keyword">sizeof</span>(next));</span><br><span class="line">        <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">        eos = <span class="number">0</span>;</span><br><span class="line">        ASCII = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insertTrie</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> str[], Node *root, <span class="keyword">int</span> label)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> Node *p;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> i, idx, eos;</span><br><span class="line">    p = root, eos = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; str[i]; i++) &#123;</span><br><span class="line">        idx = str[i] - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;next[idx] == <span class="literal">NULL</span>) &#123;</span><br><span class="line">            p-&gt;next[idx] = <span class="keyword">new</span> Node();</span><br><span class="line">            p-&gt;next[idx]-&gt;prev = p;</span><br><span class="line">            p-&gt;next[idx]-&gt;ASCII = idx;</span><br><span class="line">        &#125;</span><br><span class="line">        eos |= p-&gt;eos;</span><br><span class="line">        p = p-&gt;next[idx];</span><br><span class="line">        p-&gt;eos |= eos;</span><br><span class="line">    &#125;</span><br><span class="line">    p-&gt;eos |= label;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">freeTrie</span><span class="params">(Node *root)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;Node*&gt; Q;</span><br><span class="line">    Node *nd;</span><br><span class="line">    Q.push(root);</span><br><span class="line">    <span class="keyword">while</span>(!Q.empty()) &#123;</span><br><span class="line">        nd = Q.front(), Q.pop();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(nd-&gt;next[i] != <span class="literal">NULL</span>)</span><br><span class="line">                Q.push(nd-&gt;next[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">delete</span> nd;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">buildACautomation</span><span class="params">(Node *root)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;Node*&gt; Q;</span><br><span class="line">    Node *nd, *p;</span><br><span class="line">    root-&gt;fail = <span class="literal">NULL</span>;</span><br><span class="line">    Q.push(root);</span><br><span class="line">    <span class="keyword">while</span>(!Q.empty()) &#123;</span><br><span class="line">        nd = Q.front(), Q.pop();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(nd-&gt;next[i] == <span class="literal">NULL</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            Q.push(nd-&gt;next[i]);</span><br><span class="line">            p = nd-&gt;fail;</span><br><span class="line">            <span class="keyword">while</span>(p != <span class="literal">NULL</span> &amp;&amp; p-&gt;next[i] == <span class="literal">NULL</span>)</span><br><span class="line">                p = p-&gt;fail;</span><br><span class="line">            <span class="keyword">if</span>(p == <span class="literal">NULL</span>)</span><br><span class="line">                nd-&gt;next[i]-&gt;fail = root;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                nd-&gt;next[i]-&gt;fail = p-&gt;next[i];</span><br><span class="line">                nd-&gt;next[i]-&gt;eos |= p-&gt;next[i]-&gt;eos;<span class="comment">//special for dp</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">10000007</span>;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">dp</span><span class="params">(Node *root, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;Node*&gt; Q;</span><br><span class="line">    Node *nd, *p;</span><br><span class="line">    root-&gt;dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> k, i, j;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans, ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt;= len; k++) &#123;</span><br><span class="line">        Q.push(root);</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(!Q.empty()) &#123;</span><br><span class="line">            nd = Q.front(), Q.pop();</span><br><span class="line">            <span class="keyword">for</span>(i = (k == <span class="number">0</span>); i &lt; <span class="number">10</span>; i++) &#123; <span class="comment">// leading 0's are not allowed</span></span><br><span class="line">                <span class="keyword">if</span>(nd-&gt;next[i] != <span class="literal">NULL</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(nd-&gt;next[i]-&gt;eos)</span><br><span class="line">                        <span class="keyword">continue</span>;<span class="comment">//not safe</span></span><br><span class="line">                    nd-&gt;next[i]-&gt;dp[k+<span class="number">1</span>] += nd-&gt;dp[k];</span><br><span class="line">                    nd-&gt;next[i]-&gt;dp[k+<span class="number">1</span>] %= mod;</span><br><span class="line">                    Q.push(nd-&gt;next[i]);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    p = nd;</span><br><span class="line">                    <span class="keyword">while</span>(p != root &amp;&amp; p-&gt;next[i] == <span class="literal">NULL</span>)</span><br><span class="line">                        p = p-&gt;fail;</span><br><span class="line">                    p = p-&gt;next[i];</span><br><span class="line">                    <span class="keyword">if</span>(p == <span class="literal">NULL</span>) <span class="comment">// error message</span></span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">"NULL"</span>);</span><br><span class="line">                    <span class="keyword">if</span>(p-&gt;eos)</span><br><span class="line">                        <span class="keyword">continue</span>;<span class="comment">//not safe</span></span><br><span class="line">                    p-&gt;dp[k+<span class="number">1</span>] += nd-&gt;dp[k];</span><br><span class="line">                    p-&gt;dp[k+<span class="number">1</span>] %= mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ans += nd-&gt;dp[k];</span><br><span class="line">            ans %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k == len) &#123;</span><br><span class="line">            ret += ans;</span><br><span class="line">            ret %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, p, i;</span><br><span class="line">    <span class="keyword">int</span> cases = <span class="number">0</span>, testcase;</span><br><span class="line">    <span class="keyword">char</span> pattern[<span class="number">105</span>], s[<span class="number">105</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</span><br><span class="line">    <span class="keyword">while</span>(testcase--) &#123;</span><br><span class="line">        Node *root = <span class="keyword">new</span> Node();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %s"</span>, &amp;n, pattern);</span><br><span class="line">        insertTrie(pattern, root, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        	s[<span class="number">0</span>] = i + <span class="string">'0'</span>, s[<span class="number">1</span>] = <span class="string">'\0'</span>;</span><br><span class="line">        	insertTrie(s, root, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        buildACautomation(root);</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = dp(root, n);</span><br><span class="line">        freeTrie(root);</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">1</span> &amp;&amp; <span class="built_in">strcmp</span>(<span class="string">"0"</span>, pattern))</span><br><span class="line">        	ret++;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ret);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">3</span><br><span class="line">1 3</span><br><span class="line">2 13</span><br><span class="line">2 1</span><br><span class="line"></span><br><span class="line">*/</span></span><br></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/categories/解題區/page/53/">&laquo; Prev</a><a class="page-number" href="/categories/解題區/">1</a><span class="space">&hellip;</span><a class="page-number" href="/categories/解題區/page/52/">52</a><a class="page-number" href="/categories/解題區/page/53/">53</a><span class="page-number current">54</span><a class="page-number" href="/categories/解題區/page/55/">55</a><a class="page-number" href="/categories/解題區/page/56/">56</a><span class="space">&hellip;</span><a class="page-number" href="/categories/解題區/page/62/">62</a><a class="extend next" rel="next" href="/categories/解題區/page/55/">Next &raquo;</a>
    </nav>
  
</section>
          
            <aside id="sidebar">
  <div id="ukagaka_panel"></div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">108</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">38</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">28</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">617</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">479</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">76</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">39</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2016/06/30/diary-201606-2/">
              
                <i class="icon-file-o"></i> 
              
            走在平行道路上－後篇</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/29/diary-201606/">
              
                <i class="icon-file-o"></i> 
              
            走在平行道路上－前篇</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/28/jg-10116/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10116. Fast Dynamic Programming Computing I (OpenMP)</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/28/jg-10113/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10113. Longest Common Subsequence II (CUDA)</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/28/jg-10112/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10112. Longest Common Subsequence (CUDA)</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/28/jg-10111/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10111. Longest Common Subsequence II (OpenMP)</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/28/jg-10110/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10110. Longest Common Subsequence (OpenMP)</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/28/jg-10109/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10109. Sorting (CUDA)</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/28/jg-10108/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10108. Streams and Concurrency II (CUDA)</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/28/jg-10107/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10107. Sparse Matrix Multiplication (CUDA)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮可"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="http://tyan.io/" title=""><i class="icon-github-alt"></i> Tyan Blog</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://plus.google.com/u/0/108158678174364359204" target="_blank" title="Google+"><i class="icon-google-plus-sign"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2016 Shiang-Yun Yang 
    </div>  

  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>