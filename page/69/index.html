<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Morris' Blog">
<meta property="og:url" content="http://morris821028.github.io/page/69/index.html">
<meta property="og:site_name" content="Morris' Blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris' Blog">
<meta name="twitter:description">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          <section id="main">
  
    <article id="post-oj/uva/uva-1030" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/31/oj/uva/uva-1030/" class="article-date">
  <time datetime="2014-05-31T12:06:01.000Z" itemprop="datePublished">2014-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/31/oj/uva/uva-1030/">UVa 1030 - Image Is Everything</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/31/oj/uva/uva-1030/" data-id="cipwal5fe02d7xoxcan2qe147" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/31/oj/uva/uva-1030/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/迭代更新/">迭代更新</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Your new company is building a robot that can hold small lightweight objects. The robot will have the intelligence to determine if an object is light enough to hold. It does this by taking pictures of the object from the 6 cardinal directions, and then inferring an upper limit on the object’s weight based on those images. You must write a program to do that for the robot.</p>
<p>You can assume that each object is formed from an N×N×N lattice of cubes, some of which may be missing. Each 1×1×1 cube weighs 1 gram, and each cube is painted a single solid color. The object is not necessarily connected.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The input for this problem consists of several test cases representing different objects. Every case begins with a line containing N, which is the size of the object ( 1 &lt;= N &lt;= 10). The next N lines are the different N×N views of the object, in the order front, left, back, right, top, bottom. Each view will be separated by a single space from the view that follows it. The bottom edge of the top view corresponds to the top edge of the front view. Similarly, the top edge of the bottom view corresponds to the bottom edge of the front view. In each view, colors are represented by single, unique capital letters, while a period (.) indicates that the object can be seen through at that location.</p>
<p>Input for the last test case is followed by a line consisting of the number 0.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each test case, print a line containing the maximum possible weight of the object, using the format shown below.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">.R. YYR .Y. RYY .Y. .R.</span><br><span class="line">GRB YGR BYG RBY GYB GRB</span><br><span class="line">.R. YRR .Y. RRY .R. .Y.</span><br><span class="line">2</span><br><span class="line">ZZ ZZ ZZ ZZ ZZ ZZ</span><br><span class="line">ZZ ZZ ZZ ZZ ZZ ZZ</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Maximum weight: 11 gram(s)</span><br><span class="line">Maximum weight: 8 gram(s)</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述：</strong></p>
<p>現在有一些著色的立方體 1x1x1，每一個立方小塊會由一個顏色構成， 然後這些立方塊會疊在一起，最大為 N <em> N </em> N 。機器人在周圍拍照，將六個影像傳回來，請問現在最多可能有多少立方塊。</p>
<p><strong> 題目解法：</strong></p>
<p>這題最麻煩的是座標假想。</p>
<p>現在眼前有一個立方體，而前方是 Y 軸正向，右手是 X 軸正向，上方是 Z 軸正向。</p>
<p>而對於每一個面來說，機器人相當於在 X-Y 平面上走動。拍攝的時候，X 軸是往下方正向，Y 軸是往右方正向。</p>
<p>接著，先把空洞挖掉。再者，把所有可能進行標記，接著嘗試把那一面貼上去，對於不符合顏色的立方塊拔掉，直到六個面都屬於符合的狀態 (迭代更新)。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> cube[<span class="number">16</span>][<span class="number">16</span>][<span class="number">16</span>];</span><br><span class="line"><span class="comment">// front, left, back, right, top, bottom</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getXYZ</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> kind, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> d, <span class="keyword">int</span> &amp;rx, <span class="keyword">int</span> &amp;ry, <span class="keyword">int</span> &amp;rz)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span>(kind) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            rx = y, ry = d, rz = N - x - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            rx = d, ry = N - y - <span class="number">1</span>, rz = N - x - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            rx = N - y - <span class="number">1</span>, ry = N - d - <span class="number">1</span>, rz = N - x - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            rx = N - d - <span class="number">1</span>, ry = y, rz = N - x - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            rx = y, ry = N - x - <span class="number">1</span>, rz = N - d - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            rx = y, ry = x, rz = d;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> views[<span class="number">6</span>][<span class="number">16</span>][<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> N; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N) == <span class="number">1</span> &amp;&amp; N; )  &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, z;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">6</span>; j++)</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;views[j][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">memset</span>(cube, <span class="string">'?'</span>, <span class="keyword">sizeof</span>(cube));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">6</span>; k++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j++) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(views[k][i][j] != <span class="string">'.'</span>)</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> d = <span class="number">0</span>; d &lt; N; d++) &#123;</span><br><span class="line">                        getXYZ(N, k, i, j, d, x, y, z);</span><br><span class="line">                        cube[x][y][z] = <span class="string">'.'</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">bool</span> update = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            update = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">6</span>; k++) &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j++) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(views[k][i][j] == <span class="string">'.'</span>)</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        <span class="keyword">for</span>(<span class="keyword">int</span> d = <span class="number">0</span>; d &lt; N; d++) &#123;</span><br><span class="line">                            getXYZ(N, k, i, j, d, x, y, z);</span><br><span class="line">                            <span class="keyword">if</span>(cube[x][y][z] == <span class="string">'.'</span>)</span><br><span class="line">                                <span class="keyword">continue</span>;</span><br><span class="line">                            <span class="keyword">if</span>(cube[x][y][z] == <span class="string">'?'</span>) &#123;</span><br><span class="line">                                cube[x][y][z] = views[k][i][j];</span><br><span class="line">                                update = <span class="literal">true</span>;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(cube[x][y][z] == views[k][i][j]) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;	</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cube[x][y][z] = <span class="string">'.'</span>;</span><br><span class="line">                                update = <span class="literal">true</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span>(update == <span class="literal">true</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; N; k++)</span><br><span class="line">                    ret += cube[i][j][k] != <span class="string">'.'</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Maximum weight: %d gram(s)\n"</span>, ret);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">front, left, back, right, top, bottom.</span><br><span class="line">3</span><br><span class="line">.R. YYR .Y. RYY .Y. .R.</span><br><span class="line">GRB YGR BYG RBY GYB GRB</span><br><span class="line">.R. YRR .Y. RRY .R. .Y.</span><br><span class="line">2</span><br><span class="line">ZZ ZZ ZZ ZZ ZZ ZZ</span><br><span class="line">ZZ ZZ ZZ ZZ ZZ ZZ</span><br><span class="line">0</span><br><span class="line">*/</span></span><br></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-675" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/31/oj/uva/uva-675/" class="article-date">
  <time datetime="2014-05-31T11:59:51.000Z" itemprop="datePublished">2014-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/31/oj/uva/uva-675/">UVa 675 - Convex Hull of the Polygon</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/31/oj/uva/uva-675/" data-id="cipwal6z2031bxoxcr9mddvhz" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/31/oj/uva/uva-675/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/凸包/">凸包</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Suppose that a polygon is represented by a set of integer coordinates, {(x0, y0), (x1, y1), (x2, y2), …, (xn, yn), (x0, y0)}. Please find the convex hull of the polygon, where a convex hull is the minimum bounding convex polygon and “convex” means the angle between two consecutive edges is less than 180o.</p>
<h2 id="Input-file"><a href="#Input-file" class="headerlink" title="Input file"></a>Input file</h2><p>Input consists of several datasets separated by a blank line. Each dataset contains a sequence of integer coordinates xi, yi, one in each line. All input sequence will contain at least 3 different points.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>The output for each dataset should contain a sequence of integer coordinates xi, yi specifying the convex hull, each in a line. The first coordinate of the output sequence must be the first coordinate in the input sequence that belongs to the convex hull. The output sequence must be in counter-cockwise order. Print a blank line between datasets.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0, 0</span><br><span class="line">2, 0</span><br><span class="line">1, 1</span><br><span class="line">2, 2</span><br><span class="line">0, 2</span><br><span class="line">0, 0</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0, 0</span><br><span class="line">2, 0</span><br><span class="line">2, 2</span><br><span class="line">0, 2</span><br><span class="line">0, 0</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>題目相當單純要輸出凸包的結果，但是最痛恨的是輸出格式，要求從輸入順序中最小的開始打印。</p>
<p>莫名其妙地弄了很多 WA 出來，也許輸入有重複點的關係，所以把點附加輸入編號可能會有所錯誤，總是暴力查找一個哪個點是要開始打印的即可。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">struct Pt &#123;</span><br><span class="line">    int x, y;</span><br><span class="line">    Pt(int a = 0, int b = 0):</span><br><span class="line">        x(a), y(b) &#123;&#125;</span><br><span class="line">    bool operator &lt;(const Pt &amp;a) const &#123;</span><br><span class="line">        if(x != a.x)       </span><br><span class="line">            return x &lt; a.x;</span><br><span class="line">        return y &lt; a.y;</span><br><span class="line">    &#125;   </span><br><span class="line">    bool operator ==(const Pt &amp;a) const &#123;</span><br><span class="line">        return x == a.x &amp;&amp; y == a.y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">int cross(Pt o, Pt a, Pt b) &#123;</span><br><span class="line">    return (a.x-o.x)*(b.y-o.y)-(a.y-o.y)*(b.x-o.x);</span><br><span class="line">&#125;</span><br><span class="line">int monotone(int n, Pt p[], Pt ch[]) &#123;</span><br><span class="line">    sort(p, p+n);</span><br><span class="line">    int i, m = 0, t;</span><br><span class="line">    for(i = 0; i &lt; n; i++) &#123;</span><br><span class="line">        while(m &gt;= 2 &amp;&amp; cross(ch[m-2], ch[m-1], p[i]) &lt;= 0)</span><br><span class="line">            m--;</span><br><span class="line">        ch[m++] = p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    for(i = n-1, t = m+1; i &gt;= 0; i--) &#123;</span><br><span class="line">        while(m &gt;= t &amp;&amp; cross(ch[m-2], ch[m-1], p[i]) &lt;= 0)</span><br><span class="line">            m--;</span><br><span class="line">        ch[m++] = p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    return m - 1;</span><br><span class="line">&#125;</span><br><span class="line">Pt D[100005], C[100005&lt;&lt;1], p;</span><br><span class="line">Pt I[100005];</span><br><span class="line">int main() &#123;</span><br><span class="line">    int cases = 0;</span><br><span class="line">    char s[1024];</span><br><span class="line">    while(gets(s)) &#123;</span><br><span class="line">        if(cases++ &gt; 0)</span><br><span class="line">            puts("");</span><br><span class="line">        int n = 0, m, x, y;</span><br><span class="line">        sscanf(s, "%d, %d", &amp;x, &amp;y);</span><br><span class="line">        I[n] = D[n] = Pt(x, y);</span><br><span class="line">        n++;</span><br><span class="line">        while(gets(s) &amp;&amp; s[0] != '\0') &#123;</span><br><span class="line">            sscanf(s, "%d, %d", &amp;x, &amp;y);</span><br><span class="line">            I[n] = D[n] = Pt(x, y);</span><br><span class="line">            n++;</span><br><span class="line">        &#125;</span><br><span class="line">        m = monotone(n, D, C);</span><br><span class="line">        int mark = -1;</span><br><span class="line">        for(int i = 0; i &lt; n &amp;&amp; mark == -1; i++) &#123;</span><br><span class="line">            for(int j = 0; j &lt; m; j++)</span><br><span class="line">                if(C[j] == I[i]) &#123;</span><br><span class="line">                    mark = j;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        for(int i = mark; i &lt; m; i++)</span><br><span class="line">            printf("%d, %d\n", C[i].x, C[i].y);	</span><br><span class="line">        for(int i = 0; i &lt;= mark; i++)</span><br><span class="line">            printf("%d, %d\n", C[i].x, C[i].y);	</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-11260" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/31/oj/uva/uva-11260/" class="article-date">
  <time datetime="2014-05-31T11:48:22.000Z" itemprop="datePublished">2014-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/31/oj/uva/uva-11260/">UVa 11260 - Odd Root Sum</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/31/oj/uva/uva-11260/" data-id="cipwal5mw02grxoxc876uodq5" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/31/oj/uva/uva-11260/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/規律/">規律</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/逆元/">逆元</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Given the value of an n you will have to find the modulo 100000000 value of the following expression:</p>
<p><code>floor(sqrt(1)) + floor(sqrt(3)) + floor(sqrt(5)) + ... + floor(sqrt(m))</code> , where m is the largest odd number not greater than n. Or in other words you will have to find the value of S where,</p>
<p><code>S = floor(sqrt(1)) + floor(sqrt(3)) + floor(sqrt(5)) + ... + floor(sqrt(m)) MOD 100000000</code></p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The input file contains at most 30000 lines of inputs. Each line contains a single 64-nit signed integer which denotes the value of n. Input is terminated by a line containing a single zero which should not b processed.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each line of input produce one line of output. This line contains the value of S.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">9</span><br><span class="line">19</span><br><span class="line">29</span><br><span class="line">10000000</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h2 id="Output-for-Sample-Input"><a href="#Output-for-Sample-Input" class="headerlink" title="Output for Sample Input"></a>Output for Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">9</span><br><span class="line">26</span><br><span class="line">49</span><br><span class="line">38426378</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>先把前幾項列出來，會發現一個規律<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">11</span><br><span class="line">22</span><br><span class="line">3333</span><br><span class="line">4444</span><br><span class="line">555555</span><br><span class="line">666666</span><br><span class="line">77777777</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>每一次會增加兩個。</p>
<p>假設第 1 組為 <code>11 22</code>，第 2 組為 <code>3333 4444</code> …<br>需要使用二分搜尋找到我們總共要幾組，然後直接利用公式算出來 sigma(2i * (2i - 1 + 2i))。</p>
<p>但是公式算出來後，會有一個 <code>/3</code> 需要出處理，這邊使用乘法反元素，幸好 3 和 100000000 有互質，不然還真是沒有辦法避免大數運算，計算的時候請各種小心 overflow 的問題。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 100000000 </span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">inv</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n, <span class="keyword">long</span> <span class="keyword">long</span> m)</span> </span>&#123; <span class="comment">// get n*? = 1 (mod m)</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> la = <span class="number">1</span>, lb = <span class="number">0</span>, ra = <span class="number">0</span>, rb = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> i = <span class="number">0</span>, t, mod = m;</span><br><span class="line">    <span class="keyword">while</span>(n%m) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!i) &#123;</span><br><span class="line">            la -= n/m*ra;</span><br><span class="line">            lb -= n/m*rb;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ra -= n/m*la;</span><br><span class="line">            rb -= n/m*lb;</span><br><span class="line">        &#125;</span><br><span class="line">        i = !i;</span><br><span class="line">        t = n, n = m, m = t%m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(i)</span><br><span class="line">        <span class="keyword">return</span> (la%mod+mod)%mod;</span><br><span class="line">    <span class="keyword">return</span> (ra%mod+mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">getM</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> l = <span class="number">0</span>, r = <span class="number">3037000499L</span>L/<span class="number">2</span>, m, ret;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> tmp;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r) &#123;</span><br><span class="line">        m = (l + r) / <span class="number">2</span>;</span><br><span class="line">        tmp = <span class="number">4</span> * (m) * (m + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(tmp &lt;= n)</span><br><span class="line">            l = m + <span class="number">1</span>, ret = m;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r = m - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> n;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> inv3 = inv(<span class="number">3</span>, MOD);</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%llu"</span>, &amp;n) == <span class="number">1</span> &amp;&amp; n) &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;<span class="comment">/*</span><br><span class="line">        for(long long i = 1; i &lt;= n; i += 2) &#123;</span><br><span class="line">            // printf("%d\n", (int)sqrt(i));</span><br><span class="line">            ret += (long long) sqrt(i);</span><br><span class="line">            ret %= MOD;</span><br><span class="line">        &#125;</span><br><span class="line">        printf("%lld\n", ret);*/</span></span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> m = getM(n);</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> prev = <span class="number">4</span>*(m)*(m + <span class="number">1</span>)%MOD*(<span class="number">2</span>*m + <span class="number">1</span>)%MOD*inv3%MOD - m * (m + <span class="number">1</span>)%MOD;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> pn = <span class="number">4</span> * (m) * (m + <span class="number">1</span>) - <span class="number">1</span>;</span><br><span class="line">        prev = (prev%MOD + MOD)%MOD;</span><br><span class="line">        <span class="comment">//printf("%lld %lld %lld\n", m, prev, pn);</span></span><br><span class="line">        m++;</span><br><span class="line">        <span class="keyword">if</span>(pn + m * <span class="number">4</span> &lt; n) &#123;</span><br><span class="line">            prev += (<span class="number">2</span> * m - <span class="number">1</span>) * <span class="number">2</span> * m%MOD;</span><br><span class="line">            pn += m * <span class="number">4</span>;</span><br><span class="line">            <span class="comment">//printf("CROSS1 %llu %llu\n", pn, prev);</span></span><br><span class="line">            prev += (n - pn)/<span class="number">2</span> * <span class="number">2</span> * m%MOD;</span><br><span class="line">            <span class="comment">//printf("CROSS2 %llu %llu\n", m * 2, (n - pn) /2);</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            prev += (n - pn)/<span class="number">2</span> * (<span class="number">2</span> * m - <span class="number">1</span>)%MOD;</span><br><span class="line">            <span class="comment">//puts("CROSS3");</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%llu\n"</span>, (prev%MOD + MOD)%MOD);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">11</span><br><span class="line">22</span><br><span class="line">3333</span><br><span class="line">4444</span><br><span class="line">555555</span><br><span class="line">666666</span><br><span class="line">77777777</span><br><span class="line">...</span><br><span class="line">*/</span></span><br><span class="line"><span class="comment">/*</span><br><span class="line">10000000001</span><br><span class="line">*/</span></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-lesson/hw-nachos4-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/30/lesson/hw-nachos4-2/" class="article-date">
  <time datetime="2014-05-30T05:34:19.000Z" itemprop="datePublished">2014-05-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>►<a class="article-category-link" href="/categories/學校課程/作業系統/">作業系統</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/30/lesson/hw-nachos4-2/">向 NachOS 4.0 作業進發 (2)</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/30/lesson/hw-nachos4-2/" data-id="cipwal4yz023zxoxc1y5r3tcb" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/30/lesson/hw-nachos4-2/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NachOS/">NachOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/作業系統/">作業系統</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h1 id="接續"><a href="#接續" class="headerlink" title="接續"></a>接續</h1><p>接續上一篇的 <a href="http://morris821028.github.io/2014/05/24/hw-nachos4/">向 NachOS 4.0 作業進發 (1)</a>，我們繼續完成排程處理，在原始的 NachOS 4.0 中，基礎排程是 Round-robin，它的運作方式藉由定時呼叫 <code>threads/alarm.h</code> 中的 <code>Alarm::CallBack()</code>，而呼叫的時脈來源設定為 <code>machine/stats.h</code> 中的 <code>const int TimerTicks = 100;</code> 決定，數值越小表示呼叫頻率越高，置換的次數就會上升。</p>
<h1 id="目標-Scheduler"><a href="#目標-Scheduler" class="headerlink" title="目標 Scheduler"></a>目標 Scheduler</h1><ul>
<li>FIFO (FCFS) 先來先服務</li>
<li>SJF     最短工作優先</li>
<li>Priority 最小優先權優先</li>
<li>RR    (Round-robin)</li>
<li>multi-level queue <strong> 最後的大魔王 </strong></li>
</ul>
<h1 id="開始"><a href="#開始" class="headerlink" title="開始"></a>開始</h1><h2 id="第一步-測試"><a href="#第一步-測試" class="headerlink" title="第一步 - 測試"></a>第一步 - 測試</h2><p>先來說說怎麼測試自己的寫的代碼正確性，不然怎麼寫都只是理論腦補，雖然會動，但是不知道是否寫對。</p>
<ul>
<li><p>第一種方式為下達 </p>
<pre><code>$ ./nachos -e ../test/test1 -e ../test/test2 ... 多個
</code></pre><p>  這樣必須自己設置優先權、Burst Time，這方面撰寫方式有兩種，其一是來亂，其二是較為正式，而在 Burst Time 的計算又分成兩種，一是執行前已知、二是執行時猜測。</p>
<ul>
<li><p>其一來亂寫法，</p>
<pre><code>$ ./nachos -e ../test/test1 -e ../test/test2 ... 多個
</code></pre><p>  不改變原本的的執行方式，直接在代碼中決策 thread fork 出來時所擁有的優先權和 Burst Time。<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> testPriority = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">void</span> </span><br><span class="line">Thread::Fork(VoidFunctionPtr func, <span class="keyword">void</span> *arg)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// morris add</span></span><br><span class="line">    testPriority++;</span><br><span class="line">    <span class="keyword">if</span>(testPriority == <span class="number">1</span>)</span><br><span class="line">        setPriority(<span class="number">64</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(testPriority == <span class="number">2</span>)</span><br><span class="line">        setPriority(<span class="number">128</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        setPriority(<span class="number">64</span>);</span><br><span class="line"><span class="comment">// end morris add</span></span><br></pre></td></tr></table></figure><br>  因此，您可能會寫出以上的代碼，當然我不建議這麼寫，雖然是一種測試方式，但這並不好，一開始就這麼錯得相當離譜。</p>
</li>
<li><p>其二寫法，增加下達參數，不過這些參數格式要去查閱一下他們的參數傳遞建造，我想會寫成大概的樣子為</p>
<pre><code>$ ./nachos -e ../test/test1 -pw 64 -e ../test/test2  -pw 128 ... 
</code></pre><p>  多個為了不增加工作量，這裡就沒有親自去實作。某方面來說，可能要寫很多 small program 進行測試，並且撰寫時還要預測會跑多久，這難度會稍微提高。</p>
</li>
</ul>
</li>
<li><p>第二種方式按照軟工的寫法<br>  來寫 test code 吧！如果細心一點，就會看到相關的 <code>Class::SelfTest()</code> 在很多 class 都有的，因此我們需要把 test code 寫到 SelfTest 中被呼叫。因此，不需要有實體的 process 運行，只是單純地測試我們寫的 scheduler 的排程順序是否正確。<figure class="highlight cpp"><figcaption><span>threads/thread.cc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span></span><br><span class="line"><span class="title">threadBody</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Thread *thread = kernel-&gt;currentThread;</span><br><span class="line">    <span class="keyword">while</span> (thread-&gt;getBurstTime() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        thread-&gt;setBurstTime(thread-&gt;getBurstTime() - <span class="number">1</span>);</span><br><span class="line">        kernel-&gt;interrupt-&gt;OneTick();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s: remaining %d\n"</span>, kernel-&gt;currentThread-&gt;getName(), kernel-&gt;currentThread-&gt;getBurstTime());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span></span><br><span class="line">Thread::SchedulingTest()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> thread_num = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">char</span> *name[thread_num] = &#123;<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> thread_priority[thread_num] = &#123;<span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> thread_burst[thread_num] = &#123;<span class="number">3</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    </span><br><span class="line">    Thread *t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; thread_num; i ++) &#123;</span><br><span class="line">        t = <span class="keyword">new</span> Thread(name[i]);</span><br><span class="line">        t-&gt;setPriority(thread_priority[i]);</span><br><span class="line">        t-&gt;setBurstTime(thread_burst[i]);</span><br><span class="line">        t-&gt;Fork((VoidFunctionPtr) threadBody, (<span class="keyword">void</span> *)<span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    kernel-&gt;currentThread-&gt;Yield();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>  請自行在 <code>class Thread</code> 增加 <code>setPriority()</code>, <code>setBurstTime()</code>, <code>SchedulingTest()</code> … 等 method header and body。<figure class="highlight cpp"><figcaption><span>threads/thread.h</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Thread &#123;</span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">   ...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">   ...</span><br><span class="line">    <span class="comment">// morris add</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setBurstTime</span><span class="params">(<span class="keyword">int</span> t)</span>	</span>&#123;burstTime = t;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getBurstTime</span><span class="params">()</span>		</span>&#123;<span class="keyword">return</span> burstTime;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setStartTime</span><span class="params">(<span class="keyword">int</span> t)</span>	</span>&#123;startTime = t;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getStartTime</span><span class="params">()</span>		</span>&#123;<span class="keyword">return</span> startTime;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setPriority</span><span class="params">(<span class="keyword">int</span> t)</span>	</span>&#123;execPriority = t;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getPriority</span><span class="params">()</span>		</span>&#123;<span class="keyword">return</span> execPriority;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SchedulingTest</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// some of the private data for this class is listed above</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// morris add</span></span><br><span class="line">    <span class="keyword">int</span> burstTime;	<span class="comment">// predicted burst time</span></span><br><span class="line">    <span class="keyword">int</span> startTime;	<span class="comment">// the start time of the thread</span></span><br><span class="line">    <span class="keyword">int</span> execPriority;	<span class="comment">// the execute priority of the thread</span></span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>  接著是需要 call testcode 加入到 ThreadedKernel 中。<figure class="highlight cpp"><figcaption><span>threads/kernel.cc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">ThreadedKernel::SelfTest() &#123;</span><br><span class="line">   Semaphore *semaphore;</span><br><span class="line">   SynchList&lt;<span class="keyword">int</span>&gt; *synchList;</span><br><span class="line">   </span><br><span class="line">   LibSelfTest();		<span class="comment">// test library routines</span></span><br><span class="line">   </span><br><span class="line">   currentThread-&gt;SelfTest();	<span class="comment">// test thread switching</span></span><br><span class="line">   Thread::SchedulingTest();   </span><br><span class="line">   				<span class="comment">// test semaphore operation</span></span><br><span class="line">   semaphore = <span class="keyword">new</span> Semaphore(<span class="string">"test"</span>, <span class="number">0</span>);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>  因此我們可以利用單一 module 就能進行檢查。</p>
<pre><code>$ cd code/threads
$ ./nachos
</code></pre><p>  但是這種方式，並沒有決定我們要測試哪一種類型的 scheduler，額外需要設定參數，讓其選擇建造哪一種的 <code>readyList(Thread*)</code></p>
<pre><code>$ cd code/threads
$ ./nachos FCFS
$ ./nachos SJF
$ ./nachos Priority
$ ./nachos RR
</code></pre><p>  預計要修成如上述的測試方式。<figure class="highlight cpp"><figcaption><span>threads/main.cc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span></span><br><span class="line"><span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    debug = <span class="keyword">new</span> Debug(debugArg);</span><br><span class="line">    </span><br><span class="line">    DEBUG(dbgThread, <span class="string">"Entering main"</span>);</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">    SchedulerType type = RR;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">strcmp</span>(argv[<span class="number">1</span>], <span class="string">"FCFS"</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    type = FIFO;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(argv[<span class="number">1</span>], <span class="string">"SJF"</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    type = SJF;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(argv[<span class="number">1</span>], <span class="string">"PRIORITY"</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    type = Priority;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(argv[<span class="number">1</span>], <span class="string">"RR"</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    type = RR;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">    kernel = <span class="keyword">new</span> KernelType(argc, argv);</span><br><span class="line">    kernel-&gt;Initialize(type);</span><br><span class="line">    </span><br><span class="line">    CallOnUserAbort(Cleanup);		<span class="comment">// if user hits ctl-C</span></span><br><span class="line"></span><br><span class="line">    kernel-&gt;SelfTest();</span><br><span class="line">    kernel-&gt;Run();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</li>
</ul>
<blockquote>
<p>第一步測試撰寫就這麼結束，比起撰寫新的 code，不會進行測試也是徒勞。</p>
<p>雖然這麼說，實際運作也是先寫 code 再寫 test code，因為當時還不太懂這些，所以如果已經先寫了一些也不用難過，大家都是這麼走過來的。</p>
<p>如果不知道怎麼執行，哪還有什麼撰寫的欲望，如果不知道怎麼測試，那就是在黑暗中漫步。</p>
</blockquote>
<h2 id="第二步-撰寫"><a href="#第二步-撰寫" class="headerlink" title="第二步 - 撰寫"></a>第二步 - 撰寫</h2><p>在撰寫開始前，如果使用走第一種測試方式的人，需要將實體記憶體用大一點，否則需要實作虛擬記憶體的 context-swith。</p>
<figure class="highlight cpp"><figcaption><span>machine/machine.h</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> NumPhysPages = <span class="number">64</span>;  <span class="comment">// morris modify, old value=32</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MemorySize = (NumPhysPages * PageSize);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> TLBSize = <span class="number">4</span>;			<span class="comment">// if there is a TLB, make it small</span></span><br></pre></td></tr></table></figure>
<p>若完成以上的修改，在 <code>/userprog</code> 下，執行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./nachos -e ../test/test1 -e ../test/test2 -e ../test/test1</span><br></pre></td></tr></table></figure></p>
<p>就不會跑出 segment fault 。<br><figure class="highlight cpp"><figcaption><span>threads/scheduler.h</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> SchedulerType &#123;</span><br><span class="line">        RR,     <span class="comment">// Round Robin</span></span><br><span class="line">        SJF,</span><br><span class="line">        Priority,</span><br><span class="line">        FIFO</span><br><span class="line">&#125;;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">class</span> Scheduler &#123;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    Scheduler();</span><br><span class="line">    Scheduler(SchedulerType type);		<span class="comment">// Initialize list of ready threads </span></span><br><span class="line">    ...</span><br><span class="line">    	<span class="comment">// morris add</span></span><br><span class="line">    <span class="function">SchedulerType <span class="title">getSchedulerType</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> schedulerType;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setSchedulerType</span><span class="params">(SchedulerType t)</span> </span>&#123;schedulerType = t;&#125;</span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>如果有機會查閱其他代碼，很常見會把 <code>List&lt;Thread *&gt; *readyList;</code> 改成 <code>SortedList&lt;Thread *&gt; *readyList;</code> 但是其實不用的，可以利用多形來完成，畢竟 <code>SortedList</code> 繼承 <code>List</code>。因此是不需要更動的。</p>
<p>接著，我們使用多形，在建構子中決定要用哪一種類型的排程，並且宣告相對應的 <code>compare function</code>，參照如下。<br><figure class="highlight cpp"><figcaption><span>threads/scheduler.cc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SJFCompare</span><span class="params">(Thread *a, Thread *b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a-&gt;getBurstTime() == b-&gt;getBurstTime())</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> a-&gt;getBurstTime() &gt; b-&gt;getBurstTime() ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PriorityCompare</span><span class="params">(Thread *a, Thread *b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a-&gt;getPriority() == b-&gt;getPriority())</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> a-&gt;getPriority() &gt; b-&gt;getPriority() ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">FIFOCompare</span><span class="params">(Thread *a, Thread *b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Scheduler::Scheduler</span></span><br><span class="line"><span class="comment">// 	Initialize the list of ready but not running threads.</span></span><br><span class="line"><span class="comment">//	Initially, no ready threads.</span></span><br><span class="line"><span class="comment">//----------------------------------------------------------------------</span></span><br><span class="line">Scheduler::Scheduler() &#123;</span><br><span class="line">    Scheduler(RR);</span><br><span class="line">&#125;</span><br><span class="line">Scheduler::Scheduler(SchedulerType type)</span><br><span class="line">&#123;</span><br><span class="line">    schedulerType = type;</span><br><span class="line">    <span class="keyword">switch</span>(schedulerType) &#123;</span><br><span class="line">    <span class="keyword">case</span> RR:</span><br><span class="line">        readyList = <span class="keyword">new</span> List&lt;Thread *&gt;;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> SJF:</span><br><span class="line">        readyList = <span class="keyword">new</span> SortedList&lt;Thread *&gt;(SJFCompare);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> Priority:</span><br><span class="line">        readyList = <span class="keyword">new</span> SortedList&lt;Thread *&gt;(PriorityCompare);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> FIFO:</span><br><span class="line">        readyList = <span class="keyword">new</span> SortedList&lt;Thread *&gt;(FIFOCompare);</span><br><span class="line">    &#125;</span><br><span class="line">    toBeDestroyed = <span class="literal">NULL</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><br>上述的寫法是因為沒有辦法宣告 default argument value for class。</p>
<p>如果需要搶先 (Preemptive) 設計，則在 <code>Alarm::CallBack()</code> 決定是否要呼叫 <code>interrupt-&gt;YieldOnReturn()</code> 查看是否有更需要優先的 process 要執行。<br><figure class="highlight cpp"><figcaption><span>threads/alarm.cc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> </span><br><span class="line">Alarm::CallBack() </span><br><span class="line">&#123;</span><br><span class="line">    Interrupt *interrupt = kernel-&gt;interrupt;</span><br><span class="line">    MachineStatus status = interrupt-&gt;getStatus();</span><br><span class="line">    <span class="keyword">bool</span> woken = _bedroom.MorningCall();</span><br><span class="line"></span><br><span class="line">    kernel-&gt;currentThread-&gt;setPriority(kernel-&gt;currentThread-&gt;getPriority() - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (status == IdleMode &amp;&amp; !woken &amp;&amp; _bedroom.IsEmpty()) &#123;<span class="comment">// is it time to quit?</span></span><br><span class="line">        <span class="keyword">if</span> (!interrupt-&gt;AnyFutureInterrupts()) &#123;</span><br><span class="line">        timer-&gt;Disable();	<span class="comment">// turn off the timer</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;			<span class="comment">// there's someone to preempt</span></span><br><span class="line">    <span class="keyword">if</span>(kernel-&gt;scheduler-&gt;getSchedulerType() == RR ||</span><br><span class="line">        kernel-&gt;scheduler-&gt;getSchedulerType() == Priority ) &#123;</span><br><span class="line"><span class="comment">//		interrupt-&gt;YieldOnReturn();</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"=== interrupt-&gt;YieldOnReturn ==="</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        interrupt-&gt;YieldOnReturn();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在 Burst Time 計算上，如果採用運行時估計，可以在以下代碼中進行計算。<code>kernel-&gt;stats-&gt;userTicks</code> 是執行 user program 的時間累加器 (也存有一個 system program 的時間累加器，運行 thread context-free, thread scheduling … 等時間用途。)<br><figure class="highlight cpp"><figcaption><span>threads/alarm.cc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> </span><br><span class="line">Alarm::WaitUntil(<span class="keyword">int</span> x) &#123;</span><br><span class="line">    IntStatus oldLevel = kernel-&gt;interrupt-&gt;SetLevel(IntOff);</span><br><span class="line">    Thread* t = kernel-&gt;currentThread;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// burst time</span></span><br><span class="line">    <span class="keyword">int</span> worktime = kernel-&gt;stats-&gt;userTicks - t-&gt;getStartTime();</span><br><span class="line">    t-&gt;setBurstTime(t-&gt;getBurstTime() + worktime);</span><br><span class="line">    t-&gt;setStartTime(kernel-&gt;stats-&gt;userTicks);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Alarm::WaitUntil go sleep"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    _bedroom.PutToBed(t, x);</span><br><span class="line">    kernel-&gt;interrupt-&gt;SetLevel(oldLevel);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>其實到這裡已經完成，接下來就放幾張測試結果。</p>
<p><img src="/img/multiprogramming.png" alt="multi-programming"></p>
<p><img src="/img/FCFS-1.png" alt="FCFS(1)"><br><img src="/img/FCFS-2.png" alt="FCFS(2)"></p>
<p><img src="/img/RR-1.png" alt="RR(1)"><br><img src="/img/RR-2.png" alt="RR(2)"></p>
<p><img src="/img/SJF-1.png" alt="SJF(1)"><br><img src="/img/SJF-2.png" alt="SJF(2)"></p>
<p><img src="/img/Priority-1.png" alt="Priority(1)"><br><img src="/img/Priority-2.png" alt="Priority(1)"></p>
<h1 id="最後"><a href="#最後" class="headerlink" title="最後"></a>最後</h1><p>如果在<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd code</span><br><span class="line">$ make</span><br></pre></td></tr></table></figure></p>
<p>編譯時發生錯誤，想必是兩個地方的 <code>Initialize()</code> 發生錯誤，所以請參照以下代碼進行修改。這問題是發生於我們在 <code>/threads</code> 下修改 main.cc 的關係，所以必須在每一個 kernel 宣告地方都給一個決定 scheduler 類型的參數。</p>
<p>其一,<br><figure class="highlight cpp"><figcaption><span>userprog/userkernel.h</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="string">"../threads/scheduler.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> SynchDisk;</span><br><span class="line"><span class="keyword">class</span> UserProgKernel : <span class="keyword">public</span> ThreadedKernel &#123;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">  	...</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Initialize</span><span class="params">()</span></span>;		<span class="comment">// initialize the kernel </span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Initialize</span><span class="params">(SchedulerType type)</span></span>;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><br>其二,<br><figure class="highlight cpp"><figcaption><span>userprog/userkernel.cc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">UserProgKernel::Initialize()</span><br><span class="line">&#123;</span><br><span class="line">    Initialize(RR);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span></span><br><span class="line">UserProgKernel::Initialize(SchedulerType type)</span><br><span class="line">&#123;</span><br><span class="line">    ThreadedKernel::Initialize(type);	<span class="comment">// init multithreading</span></span><br><span class="line"></span><br><span class="line">    machine = <span class="keyword">new</span> Machine(debugUserProg);</span><br><span class="line">    fileSystem = <span class="keyword">new</span> FileSystem();</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> FILESYS</span></span><br><span class="line">    synchDisk = <span class="keyword">new</span> SynchDisk(<span class="string">"New SynchDisk"</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// FILESYS</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>其三,<br><figure class="highlight cpp"><figcaption><span>network/netkernel.h</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="string">"../threads/scheduler.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> PostOfficeInput;</span><br><span class="line"><span class="keyword">class</span> PostOfficeOutput;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> NetKernel : <span class="keyword">public</span> UserProgKernel &#123;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Initialize</span><span class="params">()</span></span>;		<span class="comment">// initialize the kernel </span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Initialize</span><span class="params">(SchedulerType)</span></span>;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><br>其四,<br><figure class="highlight cpp"><figcaption><span>network/netkernel.cc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> </span><br><span class="line">NetKernel::Initialize() &#123;</span><br><span class="line">    Initialize(RR);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span></span><br><span class="line">NetKernel::Initialize(SchedulerType type)</span><br><span class="line">&#123;</span><br><span class="line">    UserProgKernel::Initialize(type);	<span class="comment">// init other kernel data structs</span></span><br><span class="line"></span><br><span class="line">    postOfficeIn = <span class="keyword">new</span> PostOfficeInput(<span class="number">10</span>);</span><br><span class="line">    postOfficeOut = <span class="keyword">new</span> PostOfficeOutput(reliability, <span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="致網路資源"><a href="#致網路資源" class="headerlink" title="致網路資源"></a>致網路資源</h1><p>感謝網路上前人們所遺留的遺產。雖然在看不懂的文字中摸索，但仍抓到了一點線索。</p>
<blockquote>
<p>我一無所有，直到見到了你們。</p>
</blockquote>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-157" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/29/oj/uva/uva-157/" class="article-date">
  <time datetime="2014-05-29T01:23:04.000Z" itemprop="datePublished">2014-05-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/29/oj/uva/uva-157/">UVa 157 - Route Finding</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/29/oj/uva/uva-157/" data-id="cipwal6qa02xtxoxccqg7zlei" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/29/oj/uva/uva-157/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SPFA/">SPFA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSSP/">SSSP</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Many cities provide a comprehensive public transport system, often integrating bus routes, suburban commuter train services and underground railways. Routes on such systems can be categorised according to the stations or stops along them. We conventionally think of them as forming lines (where the vehicle shuttles from one end of the route to the other and returns), loops (where the two ends of the <code>branch</code> are the same and vehicles circle the system in both directions) and connections, where each end of the route connects with another route. Obviously all of these can be thought of as very similar, and can connect with each other at various points along their routes. Note that vehicles can travel in both directions along all routes, and that it is only possible to change between routes at connecting stations.</p>
<p>To simplify matters, each route is given a designation letter from the set <code>A</code> to <code>Z</code>, and each station along a route will be designated by another letter from the set <code>a</code> to <code>z</code>. Connecting stations will have more than one designation. Thus an example could be:</p>
<p><img src="/img/157img1.gif" alt=""></p>
<p>A common problem in such systems is finding a route between two stations. Once this has been done we wish to find the <code>best</code> route, where <code>best</code> means <code>shortest time</code>.</p>
<p>Write a program that will read in details of such a system and then will find the fastest routes between given pairs of stations. You can assume that the trip between stations always takes 1 unit of time and that changing between routes at a connecting station takes 3 units of time.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>Input will consist of two parts. The first will consist of a description of a system, the second will consist of pairs of stations. The description will start with a number between 1 and 26 indicating how many routes there are in the system. This will be followed by that many lines, each describing a single route. Each line will start with the route identifier followed by a <code>:</code> followed by the stations along that route, in order. Connections will be indicated by an <code>=</code> sign followed by the complete alternative designation. All connections will be identified at least once, and if there are more than two lines meeting at a connection, some or of all the alternative designations may be identified together. That is, there may be sequences such as <code>...hc=Bg=Cc=Abd...</code>. If the route forms a loop then the last station will be the same as the first. This is the only situation in which station letters will be repeated. The next portion of the input file will consist of a sequence of lines each containing two stations written contiguously. The file will be terminated by a line consisting of a single #.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>Output will consist of a series of lines, one for each pair of stations in the input. Each line will consist of the time for the fastest route joining the two stations, right justified in a field of width 3, followed by a colon and a space and the sequence of stations representing the shortest journey. Follow the example shown below. Note that there will always be only one fastest route for any given pair of stations and that the route must start and finish at the named stations (not at any synonyms thereof), hence the time for the route must include the time for any inter-station transfers.</p>
<p>The example input below refers to the diagram given above.</p>
<h2 id="Sample-input"><a href="#Sample-input" class="headerlink" title="Sample input"></a>Sample input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">A:fgmpnxzabjd=Dbf</span><br><span class="line">D:b=Adac=Ccf</span><br><span class="line">B:acd=Azefg=Cbh</span><br><span class="line">C:bac</span><br><span class="line">AgAa</span><br><span class="line">AbBh</span><br><span class="line">BhDf</span><br><span class="line">#</span><br></pre></td></tr></table></figure>
<h2 id="Sample-output"><a href="#Sample-output" class="headerlink" title="Sample output"></a>Sample output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> 5: Agfdjba</span><br><span class="line"> 9: Abaz=Bdefgh</span><br><span class="line">10: Bhg=Cbac=Dcf</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述：</strong></p>
<p>這一個交通運輸工具，配置如上圖所述，以大寫字母 (<code>A</code> - <code>Z</code>) 表示哪一種線路，每一條線路上有一些站牌 (<code>a</code> - <code>z</code>)。求某線某站到某線某站的最少花費時間。</p>
<p>然而在同一個線路上，轉換一個站的成本為 <code>1</code>，如果在線路交集站換一條線路走成本為 <code>3</code>。</p>
<p>輸入上比較特別，會用 <code>=</code> 表示交集的站編號，當然有可能會遇到多個線路的站交集在一起。</p>
<p><code>Dhc=Bg=Cc=Abd</code> 則表示 D 線路上的 Dh-Dc-Dd，其中 Dc, Bg, Cc, Ab 共站。</p>
<p>可以當作雙向連通，如果有環，則會頭尾相同，例如 <code>Dhch</code>。</p>
<p><strong> 題目解法：</strong></p>
<p>題目最令人討厭的是，交集站沒有說清楚，也就是說單一線路上的轉運站沒有說清楚，但事實上會被表示在其他線路上，這裡要自己取聯集。</p>
<p>但是做聯集是件挺麻煩的事，因此在求最短路上做點手腳，把狀態表示成 <code>(某線某站, 前一次是否轉運)</code>，這麼做就方便多了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">trans_node</span><span class="params">(<span class="keyword">int</span> r, <span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">    r -= <span class="string">'A'</span>, a -= <span class="string">'a'</span>;</span><br><span class="line">    <span class="keyword">return</span> r * <span class="number">26</span> + a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse_node</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> &amp;r, <span class="keyword">int</span> &amp;a)</span> </span>&#123;</span><br><span class="line">    r = n /<span class="number">26</span> + <span class="string">'A'</span>, a = n %<span class="number">26</span> + <span class="string">'a'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[<span class="number">1024</span>], g2[<span class="number">1024</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> st, <span class="keyword">int</span> ed)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> used[<span class="number">1024</span>][<span class="number">2</span>] = &#123;&#125;, dist[<span class="number">1024</span>][<span class="number">2</span>] = &#123;&#125;, prex[<span class="number">1024</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1024</span>; i++)</span><br><span class="line">        dist[i][<span class="number">0</span>] = dist[i][<span class="number">1</span>] = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q, S;</span><br><span class="line">    Q.push(st), S.push(<span class="number">0</span>);</span><br><span class="line">    dist[st][<span class="number">0</span>] = <span class="number">0</span>, prex[st][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!Q.empty()) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = Q.front(), s = S.front();</span><br><span class="line">        Q.pop(), S.pop();</span><br><span class="line">        used[u][s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].size(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> v = g[u][i];</span><br><span class="line">            <span class="keyword">if</span>(dist[v][<span class="number">0</span>] &gt; dist[u][s] + <span class="number">1</span>) &#123;</span><br><span class="line">                dist[v][<span class="number">0</span>] = dist[u][s] + <span class="number">1</span>;</span><br><span class="line">                prex[v][<span class="number">0</span>][<span class="number">0</span>] = u, prex[v][<span class="number">0</span>][<span class="number">1</span>] = s;</span><br><span class="line">                <span class="keyword">if</span>(!used[v][<span class="number">0</span>]) &#123;</span><br><span class="line">                    used[v][<span class="number">0</span>] = <span class="number">1</span>, Q.push(v), S.push(<span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> cost = (s == <span class="number">1</span>) ? <span class="number">0</span> : <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g2[u].size(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> v = g2[u][i];</span><br><span class="line">            <span class="keyword">if</span>(dist[v][<span class="number">1</span>] &gt; dist[u][s] + cost) &#123;</span><br><span class="line">                dist[v][<span class="number">1</span>] = dist[u][s] + cost;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(cost == <span class="number">0</span>)</span><br><span class="line">                    prex[v][<span class="number">1</span>][<span class="number">0</span>] = prex[u][s][<span class="number">0</span>], prex[v][<span class="number">1</span>][<span class="number">1</span>] = prex[u][s][<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    prex[v][<span class="number">1</span>][<span class="number">0</span>] = u, prex[v][<span class="number">1</span>][<span class="number">1</span>] = s;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(!used[v][<span class="number">1</span>]) &#123;</span><br><span class="line">                    used[v][<span class="number">1</span>] = <span class="number">1</span>, Q.push(v), S.push(<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%3d: "</span>, min(dist[ed][<span class="number">0</span>], dist[ed][<span class="number">1</span>]));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">-1</span>, a = <span class="number">-1</span>, s, mm = ed;</span><br><span class="line">    <span class="keyword">if</span>(dist[ed][<span class="number">0</span>] &lt;= dist[ed][<span class="number">1</span>])</span><br><span class="line">        s = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        s = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> nr, na;</span><br><span class="line">        reverse_node(mm, nr, na);</span><br><span class="line">        <span class="keyword">if</span>(nr != r) &#123;</span><br><span class="line">            <span class="keyword">if</span>(mm != ed)	<span class="built_in">printf</span>(<span class="string">"="</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c%c"</span>, nr, na);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c"</span>, na);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> om = mm;</span><br><span class="line">        mm = prex[om][s][<span class="number">0</span>], s = prex[om][s][<span class="number">1</span>];</span><br><span class="line">        r = nr, a = na;</span><br><span class="line">    &#125; <span class="keyword">while</span>(mm != <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> line[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1024</span>; i++)</span><br><span class="line">            g[i].clear(), g2[i].clear();</span><br><span class="line">        <span class="keyword">while</span>(n--) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;line);</span><br><span class="line">            <span class="keyword">int</span> r = line[<span class="number">0</span>], preX;</span><br><span class="line">            preX = trans_node(r, line[<span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">3</span>; line[i]; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(line[i] != <span class="string">'='</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> x = trans_node(r, line[i]);</span><br><span class="line">                    <span class="keyword">int</span> y = preX;</span><br><span class="line">                    g[x].push_back(y);</span><br><span class="line">                    g[y].push_back(x);</span><br><span class="line">                    preX = x;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">int</span> x = trans_node(line[i+<span class="number">1</span>], line[i+<span class="number">2</span>]);</span><br><span class="line">                    <span class="keyword">int</span> y = preX;</span><br><span class="line">                    g2[x].push_back(y);</span><br><span class="line">                    g2[y].push_back(x);</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>, line) == <span class="number">1</span> &amp;&amp; line[<span class="number">0</span>] != <span class="string">'#'</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = trans_node(line[<span class="number">0</span>], line[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">int</span> y = trans_node(line[<span class="number">2</span>], line[<span class="number">3</span>]);</span><br><span class="line">            spfa(y, x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">4</span><br><span class="line">A:fgmpnxzabjd=Dbf</span><br><span class="line">D:b=Adac=Ccf</span><br><span class="line">B:acd=Azefg=Cbh</span><br><span class="line">C:bac</span><br><span class="line">AgAa</span><br><span class="line">AbBh</span><br><span class="line">BhDf</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">5 </span><br><span class="line">A:ab=Bbcdefghijk </span><br><span class="line">B:abc=Ajdef=Cb </span><br><span class="line">C:ab </span><br><span class="line">D:cd=Eg </span><br><span class="line">E:fg=Bf </span><br><span class="line">AaAk </span><br><span class="line">AcAk </span><br><span class="line">AbBb </span><br><span class="line">BaDd </span><br><span class="line"># </span><br><span class="line">*/</span></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-172" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/28/oj/uva/uva-172/" class="article-date">
  <time datetime="2014-05-27T23:33:52.000Z" itemprop="datePublished">2014-05-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/28/oj/uva/uva-172/">UVa 172 - Calculator Language</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/28/oj/uva/uva-172/" data-id="cipwal6tu02zdxoxcxkiqy8wi" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/28/oj/uva/uva-172/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/parsing-tree/">parsing tree</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/stack/">stack</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p> Calculator Language (CL) supports assignment, positive and negative integers and simple arithmetic. The allowable characters in a CL statement are thus:</p>
<p><img src="/img/172img1.gif" alt=""></p>
<p>All operators have the same precedence and are right associative, thus 15 - 8 - 3 = 15 - (8 - 3) = 10. As one would expect, brackets will force the expression within them to be evaluated first. Brackets may be nested arbitrarily deeply. An expression never has two operators next to each other (even if separated by a bracket), an assignment operator is always immediately preceded by a variable and the leftmost operator on a line is always an assignment. For readability, spaces may be freely inserted into an expression, except between a negative sign and a number. A negative sign will not appear before a variable. All variables are initialised to zero (0) and retain their values until changed explicitly.</p>
<p>Write a program that will accept and evaluate expressions written in this language. Each expression occupies one line and contains at least one assignment operator, and maybe more.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>Input will consist of a series of lines, each line containing a correct CL expression. No line will be longer than 100 characters. The file will be terminated by a line consisting of a single #.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>Output will consist of a series of lines, one for each line of the input. Each line will consist of a list of the final values of all variables whose value changes as a result of the evaluation of that expression. If more than one variable changes value, they should be listed in alphabetical order, separated by commas. If a variable changes value more than once in an expression, only the final value is output. A variable is said to change value if its value after the expression has been evaluated is different from its value before the expression was evaluated. If no variables change value, then print the message `No Change’. Follow the format shown below exactly.</p>
<h2 id="Sample-input"><a href="#Sample-input" class="headerlink" title="Sample input"></a>Sample input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A = B = 4</span><br><span class="line">C = (D = 2)*_2</span><br><span class="line">C = D = 2 * _2</span><br><span class="line">F = C - D</span><br><span class="line">E = D * _10</span><br><span class="line">Z = 10 / 3</span><br><span class="line">#</span><br></pre></td></tr></table></figure>
<h2 id="Sample-output"><a href="#Sample-output" class="headerlink" title="Sample output"></a>Sample output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A = 4, B = 4</span><br><span class="line">C = -4, D = 2</span><br><span class="line">D = -4</span><br><span class="line">No Change</span><br><span class="line">E = 40</span><br><span class="line">Z = 3</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述：</strong></p>
<p>給一個六則運算，並且所有運算由右往左，也就是題目提及的 <code>right associative</code>，並且在每一個運算式之後輸出有改變值的變數結果。</p>
<p><strong> 題目解法：</strong></p>
<p>要處理的問題相當多，按照一般的思路要做出 <code>right associative</code> 還不打緊，就像冪次的定義一樣，也就是把 stack 的嚴格遞增改成非嚴格遞增。</p>
<p>但是查閱討論區給定的數據後，如下所示</p>
<p>範例輸入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">B=(A=1)+(A=2)</span><br><span class="line">#</span><br></pre></td></tr></table></figure></p>
<p>範例輸出<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A = 1, B = 3</span><br></pre></td></tr></table></figure></p>
<p>這表示著連括弧運算順序都是 <code>right associative</code>，這一點相當苦惱，於是最後建造 tree，然後先拜訪右子樹、再拜訪左子樹來解決這些問題。</p>
<p>中間誤把 <code>No Change</code> 寫成 <code>No change</code>，因此卡了不少 <code>Wrong Answer</code>。</p>
<p>Sample Input:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">A = B = 4</span><br><span class="line">B=B-6+B=100</span><br><span class="line">C = (D = 2) * _2</span><br><span class="line">C = D = 2 * _2</span><br><span class="line">E = D * _10</span><br><span class="line">F = 15 - 8 - 3</span><br><span class="line">F = 15 - 8 + _3</span><br><span class="line">F=1+F=F-1</span><br><span class="line">A=((3))</span><br><span class="line">Z=Y=X=A=B=C=1+D=E=F=G=2-H=K=J=I=L=M=O=N=P=Q=R=S=T=V=U=W=3</span><br><span class="line">A=100/2</span><br><span class="line">A=100/_2</span><br><span class="line">B=(_1+A*2)/2</span><br><span class="line">B=(1+A*_2)/2</span><br><span class="line">A=(((1-2)*3)+4)</span><br><span class="line">A=((1-(2*3))+4)</span><br><span class="line">A=((1-2)*(3+4))</span><br><span class="line">A=(1-(2*(3+4)))</span><br><span class="line">A=1+2+1+1+1+1+1+1+1+1+1+1+1+1+1+11+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+3</span><br><span class="line">#</span><br></pre></td></tr></table></figure></p>
<p>AC Sample Output:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">A = 4, B = 4</span><br><span class="line">B = -6</span><br><span class="line">C = -4, D = 2</span><br><span class="line">D = -4</span><br><span class="line">E = 40</span><br><span class="line">F = 10</span><br><span class="line">No Change</span><br><span class="line">No Change</span><br><span class="line">A = 3</span><br><span class="line">A = 0, B = 0, C = 0, D = -1, E = -1, F = -1, G = -1, H = 3, I = 3, J = 3, K = 3, L = 3, M = 3, N = 3, O = 3, P = 3, Q = 3, R = 3, S = 3, T = 3, U = 3, V = 3, W = 3</span><br><span class="line">A = 50</span><br><span class="line">A = -50</span><br><span class="line">B = -50</span><br><span class="line">B = 50</span><br><span class="line">A = 1</span><br><span class="line">A = -1</span><br><span class="line">A = -7</span><br><span class="line">A = -13</span><br><span class="line">A = 62</span><br></pre></td></tr></table></figure></p>
<p>一開始還在想為什麼當 <code>B = 4</code> 時，<code>B=B-6+B=100</code> 會產出 <code>B = -6</code>，由右往左運算。</p>
<ul>
<li>B = 100</li>
<li>6 + B = 106</li>
<li>B - (6 + B) = 100 - 106 = -6</li>
<li>B assign(=) -6</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Accepted</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">priority_op</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span>(c) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'('</span>:<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'='</span>:<span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'+'</span>: <span class="keyword">case</span> <span class="string">'-'</span>:<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'*'</span>: <span class="keyword">case</span> <span class="string">'/'</span>:<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"ERROR"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">trans</span><span class="params">(<span class="keyword">char</span> infix[], <span class="keyword">char</span> buffer[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(infix);</span><br><span class="line">    <span class="keyword">char</span> *ptr = buffer;</span><br><span class="line">    <span class="built_in">stack</span>&lt;<span class="keyword">char</span>&gt; op;</span><br><span class="line">    *ptr = <span class="string">'\0'</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(infix[i] == <span class="string">'_'</span> || <span class="built_in">isdigit</span>(infix[i]) || <span class="built_in">isalpha</span>(infix[i])) &#123;</span><br><span class="line">        	<span class="keyword">while</span>(infix[i] == <span class="string">'_'</span> || <span class="built_in">isdigit</span>(infix[i]) || <span class="built_in">isalpha</span>(infix[i])) &#123;</span><br><span class="line">        		<span class="keyword">if</span>(infix[i] == <span class="string">'_'</span>)</span><br><span class="line">        			<span class="built_in">sprintf</span>(ptr, <span class="string">"-"</span>);</span><br><span class="line">        		<span class="keyword">else</span></span><br><span class="line">            		<span class="built_in">sprintf</span>(ptr, <span class="string">"%c"</span>, infix[i]);	</span><br><span class="line">            	<span class="keyword">while</span>(*ptr)    ptr++;</span><br><span class="line">            	i++;</span><br><span class="line">        	&#125;</span><br><span class="line">            <span class="built_in">sprintf</span>(ptr, <span class="string">" "</span>);	</span><br><span class="line">            <span class="keyword">while</span>(*ptr)    ptr++;</span><br><span class="line">        	i--;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        	<span class="keyword">if</span>(infix[i] == <span class="string">' '</span>)	<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(infix[i] == <span class="string">')'</span>) &#123;</span><br><span class="line">                <span class="keyword">while</span>(!op.empty() &amp;&amp; op.top() != <span class="string">'('</span>) &#123;</span><br><span class="line">                    <span class="built_in">sprintf</span>(ptr, <span class="string">"%c "</span>, op.top()), op.pop();</span><br><span class="line">                    <span class="keyword">while</span>(*ptr) ptr++;</span><br><span class="line">                &#125;</span><br><span class="line">                op.pop();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(infix[i] != <span class="string">'('</span>) &#123;</span><br><span class="line">                	<span class="keyword">if</span>(infix[i] == <span class="string">'='</span>) &#123;</span><br><span class="line">                		<span class="keyword">while</span>(!op.empty() &amp;&amp; priority_op(op.top()) &gt; priority_op(infix[i])) &#123;</span><br><span class="line">                    		<span class="built_in">sprintf</span>(ptr, <span class="string">"%c "</span>, op.top()), op.pop();</span><br><span class="line">                    		<span class="keyword">while</span>(*ptr) ptr++;</span><br><span class="line">                		&#125;</span><br><span class="line">                	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                		<span class="keyword">while</span>(!op.empty() &amp;&amp; priority_op(op.top()) &gt; priority_op(infix[i]) &amp;&amp; op.top() != <span class="string">'='</span>) &#123;</span><br><span class="line">                    		<span class="built_in">sprintf</span>(ptr, <span class="string">"%c "</span>, op.top()), op.pop();</span><br><span class="line">                    		<span class="keyword">while</span>(*ptr) ptr++;</span><br><span class="line">                		&#125;</span><br><span class="line">                	&#125;</span><br><span class="line">                &#125;</span><br><span class="line">                op.push(infix[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!op.empty()) &#123;</span><br><span class="line">        <span class="built_in">sprintf</span>(ptr, <span class="string">"%c "</span>, op.top()), op.pop();</span><br><span class="line">        <span class="keyword">while</span>(*ptr) ptr++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> Variable[<span class="number">26</span>] = &#123;&#125;, oldVal[<span class="number">26</span>] = &#123;&#125;;</span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">to_string</span><span class="params">(<span class="keyword">int</span> number)</span> </span>&#123;</span><br><span class="line">   <span class="built_in">stringstream</span> ss;<span class="comment">//create a stringstream</span></span><br><span class="line">   ss &lt;&lt; number;<span class="comment">//add number to the stream</span></span><br><span class="line">   <span class="keyword">return</span> ss.str();<span class="comment">//return a string with the contents of the stream</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode &#123;</span><br><span class="line">    <span class="built_in">string</span> 	A, B, OP;</span><br><span class="line">    <span class="keyword">int</span> 	l, r;</span><br><span class="line">    TreeNode(<span class="built_in">string</span> a=<span class="string">""</span>, <span class="built_in">string</span> b=<span class="string">""</span>, <span class="built_in">string</span> op=<span class="string">""</span>):</span><br><span class="line">        A(a), B(b), OP(op) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">TreeNode node[<span class="number">1024</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">runTree</span><span class="params">(<span class="keyword">int</span> label)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">string</span> 	A = node[label].A;</span><br><span class="line">    <span class="built_in">string</span>	B = node[label].B;</span><br><span class="line">    <span class="keyword">int</span> 	a, b;</span><br><span class="line">    <span class="keyword">if</span>(node[label].OP == <span class="string">"LEAF"</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">isalpha</span>(A[<span class="number">0</span>]))</span><br><span class="line">           	a = Variable[A[<span class="number">0</span>] - <span class="string">'A'</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">           	a = atoi(A.c_str());</span><br><span class="line">        <span class="keyword">return</span> a;	</span><br><span class="line">    &#125;</span><br><span class="line">    b = runTree(node[label].r);</span><br><span class="line">    a = runTree(node[label].l);</span><br><span class="line"><span class="comment">//	printf("%d %d\n", a, b);</span></span><br><span class="line">    <span class="comment">//cout &lt;&lt; A &lt;&lt; ", " &lt;&lt; B &lt;&lt; ", " &lt;&lt; node[label].OP &lt;&lt; endl;</span></span><br><span class="line">    <span class="keyword">switch</span>(node[label].OP[<span class="number">0</span>]) &#123;</span><br><span class="line">    	<span class="keyword">case</span> <span class="string">'+'</span>: a = a + b; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'-'</span>: a = a - b; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'*'</span>: a = a * b; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'/'</span>: a = a / b; <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'='</span>: </span><br><span class="line">        	a = b;</span><br><span class="line">        	<span class="keyword">if</span>(<span class="built_in">isalpha</span>(A[<span class="number">0</span>])) &#123;</span><br><span class="line">        		Variable[A[<span class="number">0</span>] - <span class="string">'A'</span>] = a;</span><br><span class="line">        		<span class="comment">//cout &lt;&lt; A &lt;&lt; " -- " &lt;&lt; a &lt;&lt; endl;</span></span><br><span class="line">        	&#125;</span><br><span class="line">        	<span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">buildTree</span><span class="params">(<span class="keyword">char</span> postfix[])</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="built_in">stringstream</span>	<span class="title">sin</span><span class="params">(postfix)</span></span>;</span><br><span class="line">    <span class="built_in">string</span> 			token, A, B;</span><br><span class="line">    <span class="built_in">stack</span>&lt;<span class="built_in">string</span>&gt;	stk;</span><br><span class="line">    <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;		nodeLabel;</span><br><span class="line">    <span class="keyword">int</span> 			treeSize = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">sin</span> &gt;&gt; token) &#123;</span><br><span class="line">    	<span class="keyword">if</span>(<span class="built_in">isalpha</span>(token[<span class="number">0</span>])) &#123;</span><br><span class="line">    		stk.push(token);</span><br><span class="line">    		nodeLabel.push(treeSize);</span><br><span class="line">    		node[treeSize++] = TreeNode(token, <span class="string">""</span>, <span class="string">"LEAF"</span>);</span><br><span class="line">    		</span><br><span class="line">    	&#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isdigit</span>(token[token.length() - <span class="number">1</span>])) &#123;</span><br><span class="line">    		stk.push(token);</span><br><span class="line">    		nodeLabel.push(treeSize);</span><br><span class="line">    		node[treeSize++] = TreeNode(token, <span class="string">""</span>, <span class="string">"LEAF"</span>);</span><br><span class="line">    	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            B = stk.top(), stk.pop();</span><br><span class="line">            A = stk.top(), stk.pop();</span><br><span class="line">            <span class="keyword">int</span> a, b;</span><br><span class="line">            b = nodeLabel.top(), nodeLabel.pop();</span><br><span class="line">            a = nodeLabel.top(), nodeLabel.pop();</span><br><span class="line">            nodeLabel.push(treeSize);</span><br><span class="line">            node[treeSize] = TreeNode(A, B, token);</span><br><span class="line">            node[treeSize].l = a, node[treeSize].r = b;</span><br><span class="line">            treeSize++;</span><br><span class="line">            stk.push(<span class="string">"INNER"</span>);</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    runTree(nodeLabel.top());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">char</span> infix[<span class="number">262144</span>], postfix[<span class="number">262144</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(gets(infix) &amp;&amp; infix[<span class="number">0</span>] != <span class="string">'#'</span>) &#123;</span><br><span class="line">        trans(infix, postfix);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        	oldVal[i] = Variable[i];</span><br><span class="line">        	</span><br><span class="line">        buildTree(postfix);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> f = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        	<span class="keyword">if</span>(oldVal[i] != Variable[i]) &#123;</span><br><span class="line">        		<span class="keyword">if</span>(f)	<span class="built_in">printf</span>(<span class="string">", "</span>);</span><br><span class="line">        		f = <span class="number">1</span>;</span><br><span class="line">        		<span class="built_in">printf</span>(<span class="string">"%c = %d"</span>, i + <span class="string">'A'</span>, Variable[i]);</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(f == <span class="number">0</span>)</span><br><span class="line">        	<span class="built_in">puts</span>(<span class="string">"No Change"</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        	<span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">        <span class="comment">//printf("%s\n", postfix);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-177" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/27/oj/uva/uva-177/" class="article-date">
  <time datetime="2014-05-26T23:35:58.000Z" itemprop="datePublished">2014-05-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/27/oj/uva/uva-177/">UVa 177 - Paper Folding</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/27/oj/uva/uva-177/" data-id="cipwal6u402zgxoxcn4h5fv52" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/27/oj/uva/uva-177/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/遞迴/">遞迴</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>If a large sheet of paper is folded in half, then in half again, etc, with all the folds parallel, then opened up flat, there are a series of parallel creases, some pointing up and some down, dividing the paper into fractions of the original length. If the paper is only opened <code>half-way&#39;&#39; up, so every crease forms a 90 degree angle, then (viewed end-on) it forms a</code>dragon curve’’. For example, if four successive folds are made, then the following curve is seen (note that it does not cross itself, but two corners touch):</p>
<p><img src="/img/177img1.gif" alt="UVa 177"></p>
<p>Write a program to draw the curve which appears after N folds. The exact specification of the curve is as follows:</p>
<ul>
<li>The paper starts flat, with the ``start edge’’ on the left, looking at it from above.</li>
<li>The right half is folded over so it lies on top of the left half, then the right half of the new double sheet is folded on top of the left, to form a 4-thick sheet, and so on, for N folds.</li>
<li>Then every fold is opened from a 180 degree bend to a 90 degree bend.</li>
<li>Finally the bottom edge of the paper is viewed end-on to see the dragon curve. </li>
</ul>
<p>From this view, the only unchanged part of the original paper is the piece containing the <code>start edge</code>, and this piece will be horizontal, with the <code>start edge</code> on the left. This uniquely defines the curve. In the above picture, the <code>start edge</code> is the left end of the rightmost bottom horizontal piece (marked <code>s</code>). Horizontal pieces are to be displayed with the underscore character <code>_</code>, and vertical pieces with the <code>|</code> character.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>Input will consist of a series of lines, each with a single number N (1 &lt;= N &lt;= 13). The end of the input will be marked by a line containing a zero.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>Output will consist of a series of dragon curves, one for each value of N in the input. Your picture must be shifted as far left, and as high as possible. Note that for large N, the picture will be greater than 80 characters wide, so it will look messy on the screen. The pattern for each different number of folds is terminated by a line containing a single `^’.</p>
<h2 id="Sample-input"><a href="#Sample-input" class="headerlink" title="Sample input"></a>Sample input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">4</span><br><span class="line">1</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h2 id="Sample-output"><a href="#Sample-output" class="headerlink" title="Sample output"></a>Sample output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">|_</span><br><span class="line"> _|</span><br><span class="line">^</span><br><span class="line">   _   _</span><br><span class="line">  |_|_| |_</span><br><span class="line">   _|    _|</span><br><span class="line">|_|</span><br><span class="line">^</span><br><span class="line">_|</span><br><span class="line">^</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述：</strong></p>
<p>將一個長條紙水平擺放，接著將右手邊的紙摺疊到左上邊的紙上面，接著又再重複做幾次，直到 <code>N</code> 次 ( 若將其攤平則會有 2<sup>N</sup> 個折疊區塊 )。摺疊完後，依序將其攤開，攤開的方式為：將前一次摺疊的 (想像與 <code>s</code> 重疊的那一片) 從 180 度旋轉到 90 度位置，依序攤開 N 次。</p>
<p><strong> 題目解法：</strong></p>
<p>這一題就是題目理解麻煩點，但是不難發現肯定是有遞迴需要處理的。</p>
<p>假設我們定義展開的每一根，分別為往上下左右的射線，會發現其對應關係，新的尾會跟舊的頭對照，依序對照到中間部分。</p>
<p>最後得到關係</p>
<ul>
<li>上 變成 左</li>
<li>下 變成 右</li>
<li>左 變成 下</li>
<li>右 變成 上</li>
</ul>
<p>輸出處理方面，利用一個 map 結構去完成。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="built_in">set</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; &gt; P;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> A[<span class="number">1</span>&lt;&lt;<span class="number">15</span>];</span><br><span class="line">    <span class="comment">// 0 up, 1 down, 2 left, 3 right</span></span><br><span class="line">    <span class="keyword">int</span> trans[] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> m = <span class="number">1</span>;</span><br><span class="line">    A[<span class="number">0</span>] = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = m - <span class="number">1</span>, k = m; j &gt;= <span class="number">0</span>; j--, k++)</span><br><span class="line">            A[k] = trans[A[j]];</span><br><span class="line">        m = m &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">-1</span>, y = <span class="number">0</span>, px = <span class="number">0</span>, py = <span class="number">0</span>;</span><br><span class="line">    P.clear();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(A[i] == <span class="number">0</span>)		x = px&lt;&lt;<span class="number">1</span>, y = py;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(A[i] == <span class="number">1</span>)	x = px&lt;&lt;<span class="number">1</span>, y = py - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(A[i] == <span class="number">2</span>)	x = (px&lt;&lt;<span class="number">1</span>)<span class="number">-1</span>, y = py;</span><br><span class="line">        <span class="keyword">else</span>				x = (px&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>, y = py;</span><br><span class="line">        <span class="comment">//printf("%d %d %d - %d %d\n", px, py, A[i], x, y);</span></span><br><span class="line">        <span class="keyword">if</span>(A[i] == <span class="number">0</span>) &#123;</span><br><span class="line">            P[y].insert(make_pair(x, <span class="number">0</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(A[i] == <span class="number">1</span>) &#123;</span><br><span class="line">            P[y].insert(make_pair(x, <span class="number">1</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(A[i] == <span class="number">2</span>) &#123;</span><br><span class="line">            P[y].insert(make_pair(x, <span class="number">2</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            P[y].insert(make_pair(x, <span class="number">3</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(A[i] == <span class="number">0</span>)		py++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(A[i] == <span class="number">1</span>)	py--;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(A[i] == <span class="number">2</span>)	px--;</span><br><span class="line">        <span class="keyword">else</span>				px++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span> &amp;&amp; n; ) &#123;</span><br><span class="line">        build(n);</span><br><span class="line">        <span class="keyword">int</span> mxy = <span class="number">-0x3f3f3f3f</span>, mnx = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="built_in">set</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; &gt;::iterator it = P.begin();</span><br><span class="line">        it != P.end(); it++) &#123;</span><br><span class="line">            mxy = max(mxy, it-&gt;first);</span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">set</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt;::iterator jt = it-&gt;second.begin();</span><br><span class="line">                jt != it-&gt;second.end(); jt++) &#123;</span><br><span class="line">                mnx = min(mnx, jt-&gt;first);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="built_in">set</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; &gt;::reverse_iterator it = P.rbegin();</span><br><span class="line">        it != P.rend(); it++) &#123;</span><br><span class="line">            <span class="keyword">int</span> i = mnx;</span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">set</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt;::iterator jt = it-&gt;second.begin();</span><br><span class="line">                jt != it-&gt;second.end(); jt++) &#123;</span><br><span class="line">                <span class="keyword">while</span>(i &lt; jt-&gt;first)	<span class="built_in">putchar</span>(<span class="string">' '</span>), i++;</span><br><span class="line">                i++;</span><br><span class="line">                <span class="keyword">if</span>(jt-&gt;second == <span class="number">0</span> || jt-&gt;second == <span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">putchar</span>(<span class="string">'|'</span>);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="built_in">putchar</span>(<span class="string">'_'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//printf("%d %d\n", mxy, mnx);</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"^"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-132" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/26/oj/uva/uva-132/" class="article-date">
  <time datetime="2014-05-25T22:59:01.000Z" itemprop="datePublished">2014-05-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/26/oj/uva/uva-132/">UVa 132 - Bumpy Objects</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/26/oj/uva/uva-132/" data-id="cipwal6n702wkxoxc55u9envd" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/26/oj/uva/uva-132/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/凸包/">凸包</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p><img src="/img/132img1.gif" alt="132img1"></p>
<p>Consider objects such as these. They are polygons, specified by the coordinates of a centre of mass and their vertices. In the figure, centres of mass are shown as black squares. The vertices will be numbered consecutively anti-clockwise as shown.</p>
<p>An object can be rotated to stand stably if two vertices can be found that can be joined by a straight line that does not intersect the object, and, when this line is horizontal, the centre of mass lies above the line and strictly between its endpoints. There are typically many stable positions and each is defined by one of these lines known as its base line. A base line, and its associated stable position, is identified by the highest numbered vertex touched by that line.</p>
<p>Write a program that will determine the stable position that has the lowest numbered base line. Thus for the above objects, the desired base lines would be 6 for object 1, 6 for object 2 and 2 for the square. You may assume that the objects are possible, that is they will be represented as non self-intersecting polygons, although they may well be concave.</p>
<h2 id="Input-and-Output"><a href="#Input-and-Output" class="headerlink" title="Input and Output"></a>Input and Output</h2><p>Successive lines of a data set will contain: a string of less than 20 characters identifying the object; the coordinates of the centre of mass; and the coordinates of successive points terminated by two zeroes (0 0), on one or more lines as necessary. There may be successive data sets (objects). The end of data will be defined by the string ‘#’.</p>
<p>Output will consist of the identification string followed by the number of the relevant base line.</p>
<h2 id="Sample-input"><a href="#Sample-input" class="headerlink" title="Sample input"></a>Sample input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Object2</span><br><span class="line">4 3</span><br><span class="line">3 2  5 2  6 1  7 1  6 3  4 7  1 1  2 1  0 0</span><br><span class="line">Square </span><br><span class="line">2 2</span><br><span class="line">1 1  3 1  3 3  1 3  0 0</span><br><span class="line">#</span><br></pre></td></tr></table></figure>
<h2 id="Sample-output"><a href="#Sample-output" class="headerlink" title="Sample output"></a>Sample output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Object2             6</span><br><span class="line">Square              2</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>給定一個多邊形，將會給予這個多邊形的質心和頂點。在圖中，質心表示成黑色正方形的小點，而頂點將會使用連續編號逆時針給點。</p>
<p>多邊形可以藉由旋轉放置於水平，並且穩定立起。這時可以發現，會有兩個頂點拉起的水平線，並且質心會位於水平線上的兩個端點之間。</p>
<p>通常一個多邊形具有多個這種水平放置方法，對於一個水平放置方式，可以用在水平線上最大編號的頂點描述。</p>
<p>請輸出最小水平放置的編號。</p>
<p><strong> 題目解法： </strong></p>
<p>對多邊形著手凸包計算，這裡使用單調鍊去完成凸包。接著利用內積找到質心是否在兩個水平線端點 (segment 的上方) 之間。</p>
<p>可以利用外積判斷是否在線 (line) 上。</p>
<p>好好利用數學運算，將可以在簡短的代碼完成。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#include &lt;math.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">#define eps 1e-6</span><br><span class="line">struct Pt &#123;</span><br><span class="line">    double x, y;</span><br><span class="line">    Pt(double a = 0, double b = 0):</span><br><span class="line">    	x(a), y(b) &#123;&#125;</span><br><span class="line">    bool operator&lt;(const Pt &amp;a) const &#123;</span><br><span class="line">        if(fabs(x-a.x) &gt; eps)</span><br><span class="line">            return x &lt; a.x;</span><br><span class="line">        return y &lt; a.y;</span><br><span class="line">    &#125;</span><br><span class="line">    Pt operator-(const Pt &amp;a) const &#123;</span><br><span class="line">        Pt ret;</span><br><span class="line">        ret.x = x - a.x;</span><br><span class="line">        ret.y = y - a.y;</span><br><span class="line">        return ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">double dot(Pt a, Pt b) &#123;</span><br><span class="line">    return a.x * b.x + a.y * b.y;</span><br><span class="line">&#125;</span><br><span class="line">double cross2(Pt a, Pt b) &#123;</span><br><span class="line">    return a.x * b.y - a.y * b.x;</span><br><span class="line">&#125;</span><br><span class="line">double cross(Pt o, Pt a, Pt b) &#123;</span><br><span class="line">    return (a.x-o.x)*(b.y-o.y)-(a.y-o.y)*(b.x-o.x);</span><br><span class="line">&#125;</span><br><span class="line">int between(Pt a, Pt b, Pt c) &#123;</span><br><span class="line">    return dot(c - a, b - a) &gt;= 0 &amp;&amp; dot(c - b, a - b) &gt;= 0;</span><br><span class="line">&#125;</span><br><span class="line">int onSeg(Pt a, Pt b, Pt c) &#123;</span><br><span class="line">    return between(a, b, c) &amp;&amp; fabs(cross(a, b, c)) &lt; eps;</span><br><span class="line">&#125;</span><br><span class="line">int monotone(int n, Pt p[], Pt ch[]) &#123;</span><br><span class="line">    sort(p, p+n);</span><br><span class="line">    int i, m = 0, t;</span><br><span class="line">    for(i = 0; i &lt; n; i++) &#123;</span><br><span class="line">        while(m &gt;= 2 &amp;&amp; cross(ch[m-2], ch[m-1], p[i]) &lt;= 0)</span><br><span class="line">            m--;</span><br><span class="line">        ch[m++] = p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    for(i = n-1, t = m+1; i &gt;= 0; i--) &#123;</span><br><span class="line">        while(m &gt;= t &amp;&amp; cross(ch[m-2], ch[m-1], p[i]) &lt;= 0)</span><br><span class="line">            m--;</span><br><span class="line">        ch[m++] = p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    return m - 1;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    char testcase[105];</span><br><span class="line">    Pt P[1024], CH[1024], IN[1024];</span><br><span class="line">    while(scanf("%s", testcase) == 1) &#123;</span><br><span class="line">        if(!strcmp(testcase, "#"))</span><br><span class="line">            break;</span><br><span class="line">        double 	x, y;</span><br><span class="line">        int 	n = 0, m;</span><br><span class="line">        Pt mc;</span><br><span class="line">        scanf("%lf %lf", &amp;mc.x, &amp;mc.y);</span><br><span class="line">        while(scanf("%lf %lf", &amp;x, &amp;y) == 2) &#123;</span><br><span class="line">            if(x == 0 &amp;&amp; y == 0)</span><br><span class="line">                break;</span><br><span class="line">            IN[n] = P[n] = Pt(x, y);</span><br><span class="line">            n++;</span><br><span class="line">        &#125;</span><br><span class="line">        m = monotone(n, P, CH);</span><br><span class="line">        int ret = 0x3f3f3f3f;</span><br><span class="line">        for(int i = 0, j = m - 1; i &lt; m; j = i++) &#123;</span><br><span class="line">            if(between(CH[i], CH[j], mc)) &#123;</span><br><span class="line">                int mn = 0;</span><br><span class="line">                for(int k = 0; k &lt; n; k++)</span><br><span class="line">                    if(onSeg(CH[i], CH[j], IN[k]))</span><br><span class="line">                        mn = max(mn, k);</span><br><span class="line">                ret = min(ret, mn);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        printf("%-20s%d\n", testcase, ret + 1);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-lesson/hw-multiprocess-and-multithread" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/25/lesson/hw-multiprocess-and-multithread/" class="article-date">
  <time datetime="2014-05-25T12:15:47.000Z" itemprop="datePublished">2014-05-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>►<a class="article-category-link" href="/categories/學校課程/作業系統/">作業系統</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/25/lesson/hw-multiprocess-and-multithread/">作業系統 multiprocess &amp; multithread 作業</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/25/lesson/hw-multiprocess-and-multithread/" data-id="cipwal4yo023vxoxcw6c2poyl" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/25/lesson/hw-multiprocess-and-multithread/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/multiprocess/">multiprocess</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/multithread/">multithread</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h1 id="A-班程式要求"><a href="#A-班程式要求" class="headerlink" title="A 班程式要求"></a>A 班程式要求</h1><p>請使用所熟悉的程式開發環境設計單一行程產生子行程 ( Child Process ) 與 多執行緒 ( Multi-Thread) 的程式，意即完成下列傳統 for loop 之列印工作，將其改寫成多行程與多執行緒，由不同的行程與執行緒列印不同 i 值。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"output i = %d\n"</span>, i);</span><br></pre></td></tr></table></figure>
<h1 id="注意事項"><a href="#注意事項" class="headerlink" title="注意事項"></a>注意事項</h1><ul>
<li><strong> 嚴禁從網路抄襲作業 </strong>。每份程式作業將被程式比對軟體檢查，一旦發現抄襲，該份作業以零分計，並且這學期作業系統作業成績以零分計。</li>
<li>後略</li>
</ul>
<blockquote>
<p>這種作業不抄來抄去也難。但是作業格式不清楚，所以也有不同理解方式就是了。</p>
</blockquote>
<h1 id="開始動手"><a href="#開始動手" class="headerlink" title="開始動手"></a>開始動手</h1><p>對於將 for 迴圈改寫，我們必須認知到幾項</p>
<ul>
<li>是否要按照順序輸出？</li>
<li>平台 M$, Linux, or Max OS？</li>
</ul>
<blockquote>
<p>此篇假設目標是一模一樣的輸出</p>
</blockquote>
<h2 id="multiprocess"><a href="#multiprocess" class="headerlink" title="multiprocess"></a>multiprocess</h2><p><code>child process</code> 屬於 multiprocess 中的一種方式。為什麼這麼說呢？multiprocess 只是要求一個 CPU 中有多個工作同時在進行，藉由排程器去進行工作分配。</p>
<p>先不管這些，要實作 <code>child process</code> 看起來只有走向 <code>fork()</code> 一途。而之前 inker 大神則是走非 child process 使用類似 <code>./nachos -e ../test/test1 -e ../test/test1</code> 的方式去運行。</p>
<p>為了實作按照順序輸出，我們需要 process 共同擁有的 shared memory，這個 shared memory 將要紀錄原本 for 裡面的 <code>i</code> 值和一個 <code>sem_t</code>，來保證 process 和 process 之間不會同時搶先動作，<code>sem_t</code> 也許是不需要的，這裡留給實驗者去測試。</p>
<p>為了使輸出一致，在 <code>fork()</code> 完之後，使用 <code>wait()</code> 來等待所有子程序結束。這樣會造成當 for loop 需要跑 n 次，就會總共 n 個 process，也就是一整條鏈下去。</p>
<ul>
<li>思考 <code>wait()</code> 和 <code>sem_t</code> 都不是這麼必要？// 這個要看寫法</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span>  MAP_ANONYMOUS</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span>  MAP_ANON</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAP_ANONYMOUS MAP_ANON</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> *glob_var;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> n = <span class="number">32</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    glob_var = (<span class="keyword">int</span> *)mmap(<span class="literal">NULL</span>, <span class="keyword">sizeof</span> *glob_var, PROT_READ | PROT_WRITE,</span><br><span class="line">                    MAP_SHARED | MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">sem_t</span> *sema = (<span class="keyword">sem_t</span> *)mmap(<span class="literal">NULL</span>, <span class="keyword">sizeof</span>(sema),</span><br><span class="line">                       PROT_READ |PROT_WRITE,MAP_SHARED|MAP_ANONYMOUS,</span><br><span class="line">                       <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">    sem_init(sema, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    *glob_var = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (*glob_var &lt; n) &#123;</span><br><span class="line">        sem_wait(sema);</span><br><span class="line">        <span class="keyword">int</span> pid = fork();</span><br><span class="line">        <span class="keyword">int</span> output = (*glob_var)++;</span><br><span class="line">        <span class="keyword">if</span> (output &lt; n)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d, pid = %d\n"</span>, output, pid);</span><br><span class="line">        sem_post(sema);</span><br><span class="line">        <span class="keyword">int</span> wpid, status = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((wpid = wait(&amp;status)) &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//printf("Exit status of %d was %d (%s)\n", (int)wpid, status, (status &gt; 0) ? "accept" : "reject");</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    munmap(glob_var, <span class="keyword">sizeof</span> *glob_var);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="multithread"><a href="#multithread" class="headerlink" title="multithread"></a>multithread</h2><p>Thread 就相當簡單，因為它們是共用同一個記憶體區段，因此沒有 share memory 的問題。<br>雖然使用 <code>sem_wait(&amp;sem)</code> 和 <code>sem_post(&amp;sem)</code> 來保證區域內的代碼不會同時有多個 thread 在運行，但仍遇到 <code>i = 0</code> 同時在多個 Thread 噴出的情況，這一點百思不得其解，為了解決這一切問題，使用課本提到的 <code>Producer–consumer problem</code> 寫法。</p>
<p>希望能從代碼中看懂。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;semaphore.h&gt;</span><br><span class="line">#include &lt;pthread.h&gt;</span><br><span class="line">int i = 0, n = 16;</span><br><span class="line">int count = 0;</span><br><span class="line">sem_t sem;</span><br><span class="line">const int MAX_THREAD = 4;</span><br><span class="line">void *Producer(void *arg) &#123;</span><br><span class="line">    for(int i = 0; i &lt; n;) &#123;</span><br><span class="line">        sem_wait(&amp;sem);</span><br><span class="line">        if(count == 1) &#123;</span><br><span class="line">            sem_post(&amp;sem);</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">        count++;</span><br><span class="line">        // printf("\nProducer is :%d\n", count);</span><br><span class="line">        sem_post(&amp;sem);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    pthread_exit(NULL);</span><br><span class="line">&#125;</span><br><span class="line">void *runPrint(void *arg) &#123;</span><br><span class="line">    int id = *((int *) arg);</span><br><span class="line">    for (; i &lt; n ;) &#123;</span><br><span class="line">        sem_wait(&amp;sem);</span><br><span class="line">        if (count == 0) &#123;</span><br><span class="line">            sem_post(&amp;sem);</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">        count--;</span><br><span class="line">        i++;</span><br><span class="line">        printf("loop i = %d, thread id %d\n", i, id);</span><br><span class="line">        sem_post(&amp;sem);</span><br><span class="line">    &#125;</span><br><span class="line">    pthread_exit(NULL);</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    pthread_t *threads;</span><br><span class="line">    sem_init(&amp;sem, 0, 0);</span><br><span class="line">    threads = (pthread_t *) malloc(MAX_THREAD * sizeof(pthread_t));</span><br><span class="line">    for (int i = 0; i &lt; MAX_THREAD; i++) &#123;</span><br><span class="line">        int *p = (int *) malloc(sizeof(int));</span><br><span class="line">        *p = i;</span><br><span class="line">        pthread_create(&amp;threads[i], NULL, runPrint, (void *)(p));</span><br><span class="line">    &#125;</span><br><span class="line">    pthread_t producer;</span><br><span class="line">    int *p = (int *) malloc(sizeof(int));</span><br><span class="line">    *p = -1;</span><br><span class="line">    pthread_create(&amp;producer, NULL, Producer, (void *)(p));</span><br><span class="line">    for (i = 0; i &lt; MAX_THREAD; i++) &#123;</span><br><span class="line">        pthread_join(threads[i], NULL);</span><br><span class="line">    &#125;</span><br><span class="line">    sem_destroy(&amp;sem);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h2><p>代碼沒有寫得很完整，也就是能達到輸出相同且用符合需求，這一點是有很多漏洞的，前人也是鑽漏洞交作業的。相較之下，我們 B 班的作業略顯兇殘，但是網路上資料還真是少呢，雖然還是找地方抄和理解。</p>
<p>測試的時候，為了保證輸出是穩定的，記得得多測試幾次，並且把數字範圍作變調，當然能不能讓一個 create thread 跑完整個迴圈呢？畢竟加上 main thread 就算是 multithread？haha</p>
<h1 id="執行"><a href="#執行" class="headerlink" title="執行"></a>執行</h1><h2 id="編譯"><a href="#編譯" class="headerlink" title="編譯"></a>編譯</h2><ul>
<li><p>Mac OSX</p>
<pre><code>$ clang -pthread x.cpp -o x
</code></pre></li>
<li><p>Linux</p>
<pre><code>$ gcc -lpthread x.cpp -o x
</code></pre><h2 id="運行"><a href="#運行" class="headerlink" title="運行"></a>運行</h2></li>
<li><p>Linux &amp; Max OSX</p>
<pre><code>$ ./x
</code></pre></li>
</ul>
<h1 id="Mac-運行問題"><a href="#Mac-運行問題" class="headerlink" title="Mac 運行問題"></a>Mac 運行問題</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#ifndef  MAP_ANONYMOUS</span><br><span class="line">#ifdef  MAP_ANON</span><br><span class="line">#define MAP_ANONYMOUS MAP_ANON</span><br><span class="line">#endif</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>
<p>不知道為什麼 clang 中沒有定義 <code>MAP_ANONYMOUS</code>，增加上述代碼後正確運行。</p>
<h1 id="其他作業"><a href="#其他作業" class="headerlink" title="其他作業"></a>其他作業</h1><p><a href="http://morris821028.github.io/2014/05/18/operating-system-hw-thread/">B 班程式作業 1</a><br><a href="http://morris821028.github.io/2014/05/24/hw-nachos4/">B 班程式作業 2</a></p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-lesson/consumption-item-1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/25/lesson/consumption-item-1/" class="article-date">
  <time datetime="2014-05-25T06:22:22.000Z" itemprop="datePublished">2014-05-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>►<a class="article-category-link" href="/categories/學校課程/通識課程/">通識課程</a>
  </div>

  </div>
  <div class="article-inner ">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/sungirl3.jpg" rel="gallery_cipwal4w2022fxoxck8xfvup4">
        <img src="/img/sungirl3.jpg" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/25/lesson/consumption-item-1/">當代消費文化與社會 (2)</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/25/lesson/consumption-item-1/" data-id="cipwal4w2022fxoxck8xfvup4" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/25/lesson/consumption-item-1/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/通識/">通識</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="母親節篇"><a href="#母親節篇" class="headerlink" title="母親節篇"></a>母親節篇</h2><ol>
<li>請簡述母親節與消費文化的關聯性 ?<br>母親節與消費文化原本是扯不上邊的，後來商人們藉由這些推銷的活動，給予不知道母親節要怎麼犒勞養育辛勞的兒女們一項消費選擇，因此提供了相關的優惠活動方便消費者，母親節就逐漸跟情人節送禮一樣的氣氛。</li>
<li>舉例說明母親節有哪些消費現象 ?<br>相關女性用品優惠，對於餐飲業而言就是雙人、多人套餐，而觀光景點就是帶著母親出遊享優惠 … 等等。</li>
<li>您決定購買什麼禮物送媽媽及其理由 ?<br>身為一個程序猿，買禮物卻沒有思路，寫卡片卻沒有語言，在這樣的情況下，按照自己最常做的事情下手設計，但最近還有其他程序要趕，大概是趕不上這個母親節專案了。</li>
</ol>
<h2 id="血色月灣"><a href="#血色月灣" class="headerlink" title="血色月灣"></a>血色月灣</h2><div class="video-container"><iframe src="//www.youtube.com/embed/ypeW6lSeUFc" frameborder="0" allowfullscreen></iframe></div>
<p><a href="https://www.youtube.com/watch?v=ypeW6lSeUFc" target="_blank" rel="external">Youtube</a></p>
<p>在這場被隱藏的殺戮中，繼上次壽司造成的魚類問題，沒想到日本又在海洋造成了更大的傷害，不管是不是海豚，也許有人會因為海豚可愛而在這一次的血色海灣而保護它，在我們不喜歡的動物上，說不定也有類似的問題。</p>
<p>最令人訝異的是，即使在國際會議中，也有隱瞞事實的大人物在，果然要執行某些事情，不是會議或者是組織所為，而是來自個人的發起。這句話有額外的啟發，為了背後國民的飯碗或支持，這些代表人物不得不說謊的情境，假使一開始錯了，他們便會一直錯下去，這樣的情況令人相當惋惜。</p>
<p>海豚的確很有靈性，在他們受到如此的遭遇，難免會感受到如新世界中，那些因為外表被看成不同種的情況，而受到摧殘的可能，對於靈性的動物，在受到傷害，我們給予同情，在其他情況下則沒有這麼強烈的反應。</p>
<h2 id="消費型科技商品"><a href="#消費型科技商品" class="headerlink" title="消費型科技商品"></a>消費型科技商品</h2><p>現在出門一定有 GPS 衛星導航的裝置，才能穿梭於大街小巷，這些裝置給我們相當大的便利，不用攜帶大量的地圖資訊出門，不會迷路、不用煩惱就可以輕鬆出門。</p>
<p>科技所帶來的便利，使得停下來思考的機會少了，也不會看看四周的景色，追求更快速地抵達目的地，目的地以外的機緣就越來越少了。比起問人，問機器更來得有信任感，這也表示著相信別人給的知識也不是那麼重要。根據新聞的研究報導，也許我們正在改變記憶方式，開始不擅長記繁瑣的事物，而開始擅長去哪裡找資料、如何使用資料。</p>
<p>因此，也常發生因衛星導航所造成的交通事故，被引導到錯誤地方或者是進入不合適的地點。這也反應使用者即使發現了不合理之處，最後仍相信訊息給的答案。假使衛星給了錯誤訊息，或者被惡意修改成錯誤訊息，很容易造就嚴重事故，我們已經被訓練得無法自己處理這些資訊。</p>
<p>也許老師會問我「那你認為到底要不要買衛星導航？」這一點還真的是要看需求，身為宅的人們不喜歡出門呢。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/68/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/67/">67</a><a class="page-number" href="/page/68/">68</a><span class="page-number current">69</span><a class="page-number" href="/page/70/">70</a><a class="page-number" href="/page/71/">71</a><span class="space">&hellip;</span><a class="page-number" href="/page/76/">76</a><a class="extend next" rel="next" href="/page/70/">Next &raquo;</a>
    </nav>
  
</section>
          
            <aside id="sidebar">
  <div id="ukagaka_panel"></div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">88</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">617</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">479</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">76</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">39</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2016/06/26/jg-10092/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10092. OpenCL Build Program Debug</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/26/jg-10091/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10091. Fast Matrix Multiplication (OpenCL)</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/26/jg-10090/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10090. Dot Product (OpenCL)</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/26/jg-10089/">
              
                <i class="icon-file-o"></i> 
              
            批改娘 10089. Print Platform Information (OpenCL)</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/26/uva-13100/">
              
                <i class="icon-file-o"></i> 
              
            UVa 13100 - Painting the Wall</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/26/uva-13102/">
              
                <i class="icon-file-o"></i> 
              
            UVa 13102 - Tobby Stones</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/26/uva-13101/">
              
                <i class="icon-file-o"></i> 
              
            UVa 13101 - Tobby on Tree</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/24/uva-13000/">
              
                <i class="icon-file-o"></i> 
              
            UVa 13000 - VIP Treatment</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/24/uva-13070/">
              
                <i class="icon-file-o"></i> 
              
            UVa 13070 - Palm trees in the snow</a>
          </li>
        
          <li>
            <a class="text" href="/2016/06/24/uva-13036/">
              
                <i class="icon-file-o"></i> 
              
            UVa 13036 - Birthday Gift to SJ - 2</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮可"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="http://tyan.io/" title=""><i class="icon-github-alt"></i> Tyan Blog</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://plus.google.com/u/0/108158678174364359204" target="_blank" title="Google+"><i class="icon-google-plus-sign"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2016 Shiang-Yun Yang 
    </div>  

  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>